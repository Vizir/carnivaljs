!function(){"use strict";angular.module("carnival",["carnival.templates","ui.router","carnival.components","pascalprecht.translate","textAngular","datePicker"]).config(["$stateProvider","$urlRouterProvider","$translateProvider","$locationProvider",function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"states/main/main.html",controller:"MainController"}).state("main.list",{url:"list/:entity",templateUrl:"states/main.list/list.html",controller:"ListController"}).state("main.show",{url:"show/:entity/:id",templateUrl:"states/main.show/show.html",controller:"ShowController"}).state("main.create",{url:"create/:entity",templateUrl:"states/main.create/create.html",controller:"CreateController"}).state("main.edit",{url:"edit/:entity/:id",templateUrl:"states/main.edit/edit.html",controller:"EditController"})}]).run(["Configuration","Entity",function(a,b){a.addExtraStates();for(var c=0,d=a.entities,e=d.length;e>c;c++)d[c]=new b(d[c].name,d[c].options)}]),angular.module("carnival.components.button",[]).directive("carnivalButton",function(){return{restrict:"E",replace:!0,scope:{label:"@",style:"@",size:"@"},templateUrl:"components/button/button.html"}}),angular.module("carnival.components",["carnival.components.button","carnival.components.form","carnival.components.nested-form","carnival.components.nested-form-area","carnival.components.delete-button","carnival.components.listing","carnival.components.listingfieldbelongsto","carnival.components.listingextraaction","carnival.components.listingfieldhasmany","carnival.components.listingfield","carnival.components.navbar","carnival.components.fields","carnival.components.order-controller","carnival.components.pagination-controller","carnival.components.search-controller","carnival.components.notification","carnival.components.quickfilter-controller","carnival.components.listingFieldFile","carnival.components.listingFieldCurrency","carnival.components.uploader","carnival.components.gallery","carnival.components.listingFieldEnum"]),angular.module("carnival.components.delete-button",[]).directive("carnivalDeleteButton",function(){return{restrict:"E",replace:!0,scope:{action:"=",itemId:"="},templateUrl:"components/delete-button/delete-button.html",controller:["$scope",function(a){a.isDeleting=!1,a.start=function(){a.isDeleting=!0},a.cancel=function(){a.isDeleting=!1},a.confirm=function(){a.action(a.itemId)}}]}}),angular.module("carnival.components.fields.belongsTo",[]).directive("carnivalBelongsToField",function(){return{restrict:"E",replace:!0,scope:{datas:"=",field:"=",entity:"=",state:"@",nestedFormIndex:"=",relatedResources:"=",editable:"="},templateUrl:"components/fields/belongs-to/belongs-to.html",link:function(a,b){a.editable||b.attr("disabled","true")},controller:["$rootScope","$scope",function(){}]}}),angular.module("carnival.components.fields.boolean",[]).directive("carnivalBooleanField",function(){return{restrict:"E",replace:!0,scope:{data:"=",editable:"="},templateUrl:"components/fields/boolean/boolean.html",link:function(a,b){a.editable||b.attr("disabled","true")},controller:["$scope",function(a){void 0===a.data&&(a.data=!1)}]}}),angular.module("carnival.components.fields.currency",[]).directive("carnivalCurrencyField",["$filter",function(){return{restrict:"E",scope:{data:"=",field:"="},templateUrl:"components/fields/currency/currency.html"}}]).directive("currency",["$parse",function(){return{restrict:"A",require:"?ngModel",link:function(b,c,d,e){function f(a){var b=a.replace(/^-/,"").replace(/^0*/,"");return b=b.replace(/[^0-9]/g,"")}function g(a,b){return f(parseFloat(a).toFixed(b))}function h(a){if(!a)return a;var b=a.replace(/[^\d]+/g,"");b=b.replace(/^[0]+([1-9])/,"$1");var c=o.apply(b);return a!==c&&(e.$setViewValue(c),e.$render()),c?parseInt(c.replace(/[^\d]+/g,""))/Math.pow(10,l):null}if(e){var i=b.field.currencyOptions.decimalDelimiter||".",j=b.field.currencyOptions.thousandsDelimiter||"",k=b.field.currencyOptions.symbol||"$",l=parseInt(b.field.currencyOptions.decimals,10);isNaN(l)&&(l=2);var m=l>0?i+new Array(l+1).join("0"):"",n=k+" #"+j+"##0"+m,o=new a(n,{reverse:!0});e.$formatters.push(function(a){if(angular.isUndefined(a))return a;var b=g(a,l);return o.apply(b)}),e.$parsers.push(h)}}}}]),angular.module("carnival.components.fields.date",[]).directive("carnivalDateField",function(){return{restrict:"E",replace:!0,scope:{data:"=",editable:"="},templateUrl:"components/fields/date/date.html",link:function(a,b){a.editable||b.attr("disabled","true")}}}),angular.module("carnival.components.fields.enum",[]).directive("carnivalEnumField",function(){return{restrict:"E",replace:!0,scope:{data:"=",field:"="},templateUrl:"components/fields/enum/enum.html"}}),angular.module("carnival.components.fields",["carnival.components.fields.number","carnival.components.fields.select","carnival.components.fields.belongsTo","carnival.components.fields.hasMany","carnival.components.fields.string","carnival.components.fields.text","carnival.components.fields.wysiwyg","carnival.components.fields.boolean","carnival.components.fields.date","carnival.components.fields.file","carnival.components.fields.enum","carnival.components.fields.currency"]),angular.module("carnival.components.fields.file",[]).directive("carnivalFileField",function(){return{restrict:"E",replace:!0,scope:{data:"=",field:"=",editable:"="},templateUrl:"components/fields/file/file.html",controller:["$scope","$http","Configuration",function(a){a.checkIfIsImage=function(a){return/\.(gif|jpg|jpeg|tiff|png)$/i.test(a)},a.checkIfHasUploader=function(){return"undefined"!=typeof a.field.uploader},a.checkIfHasGallery=function(){return"undefined"!=typeof a.field.gallery}}]}}),angular.module("carnival.components.fields.hasMany",[]).directive("carnivalHasManyField",function(){return{restrict:"E",replace:!0,scope:{datas:"=",field:"=",state:"@",entity:"=",nestedFormIndex:"=",relatedResources:"=",editable:"="},templateUrl:"components/fields/has-many/has-many.html",link:function(a,b){a.editable||b.attr("disabled","true")},controller:["$rootScope","$scope","utils","Configuration","$compile","$element","$document","FormService",function(a,b,c,d,e,f,g,h){b.utils=c,b.canShow=function(){return h.canShowThisHasManyField(b.entity,b.state,b.field)};var i=function(a,b){for(var c=0;c<b.length;c++)if(b[c].id===a)return c;return-1},j=function(){var a=b.relatedResources[b.field.name],c=i(b.selectedHasMany,a);return c>=0?a[c]:void 0};b.addHasManyOption=function(){var a=j();b.datas[b.field.name]||(b.datas[b.field.name]=[]),a&&b.datas[b.field.name].push(a)}}]}}),angular.module("carnival.components.fields.number",[]).directive("carnivalNumberField",function(){return{restrict:"E",replace:!0,scope:{label:"=",data:"=",editable:"="},templateUrl:"components/fields/number/number.html",link:function(a,b){a.editable||b.attr("disabled","true")}}}),angular.module("carnival.components.fields.select",[]).directive("carnivalSelectField",function(){return{restrict:"E",replace:!0,scope:{data:"=",items:"=",field:"=",identifier:"=",editable:"="},templateUrl:"components/fields/select/select.html",link:function(a,b){a.editable||b.attr("disabled","true")},controller:["$rootScope","$scope","utils",function(a,b,c){b.utils=c}]}}),angular.module("carnival.components.fields.string",[]).directive("carnivalStringField",function(){return{restrict:"E",replace:!0,scope:{label:"=",data:"=",editable:"="},templateUrl:"components/fields/string/string.html",link:function(a,b){a.editable||b.attr("disabled","true")}}}),angular.module("carnival.components.fields.text",[]).directive("carnivalTextField",function(){return{restrict:"E",replace:!0,scope:{label:"=",data:"=",editable:"="},templateUrl:"components/fields/text/text.html",link:function(a,b){a.editable||b.attr("disabled","true")}}}),angular.module("carnival.components.fields.wysiwyg",[]).directive("carnivalWysiwygField",function(){return{restrict:"E",replace:!0,scope:{label:"=",data:"=",editable:"="},templateUrl:"components/fields/wysiwyg/wysiwyg.html",link:function(a,b){a.editable||b.attr("disabled","true")}}}),angular.module("carnival.components.form",[]).directive("carnivalForm",function(){return{restrict:"E",replace:!0,scope:{entity:"=",fields:"=",action:"=",state:"@state",type:"@",datas:"=",relatedResources:"=",editable:"="},templateUrl:"components/form/form.html",controller:["$rootScope","$scope","utils","FormService","$element","EntityResources","EntityUpdater",function(a,b,c,d,e,f,g){b.utils=c,"nested"!==b.type&&d.init(),b.canShow=function(a){return d.canShowThisField(b.entity,b.state,a)};var h=function(){return b.entity.nestedForms&&Object.keys(b.entity.nestedForms).length>0},i=function(){var a=b.entity.parentEntity;b.entity=f.prepareForEditState(b.entity.name),b.entity.parentEntity=a},j=function(a){var c=b.entity.parentEntity,d=c.model.getFieldByEntityName(b.entity.name);g.updateEntity(c,d,a);var e=b.entity.identifier;b.entity[e]=a[e],b.state="edit",b.entity.datas=a},k=function(a,c){"edit"!==b.state&&h()||d.closeNested(b.entity.name),i(),j(c)};b.buttonAction=function(){var a=null;if("nested"===b.type)d.saveNested(b.entity.name),a=k;else if(d.hasUnsavedNested())return void console.log("Não é possivel salvar o form pois existem nested não salvos");b.action.click(a)}}]}}),angular.module("carnival.components.gallery",[]).directive("carnivalGallery",function(){return{restrict:"E",replace:!0,scope:{gallery:"=",fileUrl:"="},controller:["$scope",function(a){window.CARNIVAL||(window.CARNIVAL={}),window.CARNIVAL.gallery||(window.CARNIVAL.gallery={}),window.CARNIVAL.gallery.sendUrl=function(b){a.fileUrl=b},a.open=function(){window.open(a.gallery.url,"WINDOW_GALLERY","dialog")}}],templateUrl:"components/gallery/gallery.html"}}),angular.module("carnival.components.listingextraaction",[]).directive("carnivalListingExtraAction",function(){return{restrict:"E",replace:!0,scope:{extraAction:"=",item:"="},templateUrl:"components/listing-extra-action/listing-extra-action.html",controller:["$scope","$stateParams","Configuration",function(a){var b=function(b){var c=/\/:([a-z]*)($ || \/)/,d=c.exec(b);if(null===d)return b;var e=d[1],f=a.item[e];return b.replace(c,"/"+f)},c=function(){for(var c=a.extraAction.url;c.indexOf("/:")>=0;)c=b(c);return c};a.getUrl=function(){return c()},a.getLabel=function(){return a.extraAction.label}}]}}),angular.module("carnival.components.listingfieldbelongsto",[]).directive("carnivalListingFieldBelongsTo",function(){return{restrict:"E",replace:!0,scope:{item:"=",field:"="},templateUrl:"components/listing-field-belongs-to/listing-field-belongs-to.html",controller:["$scope","$stateParams","Configuration",function(a,b,c){c.getEntity(b.entity);a.getUrl=function(){var b=a.item[a.field.name+"Url"];return b||(b="#/show/"+a.field.endpoint+"/"+a.item[a.field.name].id),b},a.getLabel=function(){return a.item[a.field.name][a.field.field]}}]}}),angular.module("carnival.components.listingFieldCurrency",[]).directive("carnivalListingFieldCurrency",function(){return{restrict:"E",scope:{item:"=",field:"="},templateUrl:"components/listing-field-currency/listing-field-currency.html",link:function(b){b.toCurrency=function(c){function d(a){var b=a.replace(/^-/,"").replace(/^0*/,"");return b=b.replace(/[^0-9]/g,"")}function e(a,b){return d(parseFloat(a).toFixed(b))}var f=b.field.currencyOptions.decimalDelimiter||".",g=b.field.currencyOptions.thousandsDelimiter||"",h=b.field.currencyOptions.symbol||"$",i=parseInt(b.field.currencyOptions.decimals,10);isNaN(i)&&(i=2);var j=i>0?f+new Array(i+1).join("0"):"",k=h+" #"+g+"##0"+j,l=new a(k,{reverse:!0}),m=e(c,i);return l.apply(m)}}}}),angular.module("carnival.components.listingFieldEnum",[]).directive("carnivalListingFieldEnum",function(){return{restrict:"E",scope:{item:"=",field:"="},templateUrl:"components/listing-field-enum/listing-field-enum.html",link:function(a){a.getValue=function(b){for(var c=0,d=a.field.values.length;d>c;c+=1)if(a.field.values[c].value===b)return a.field.values[c].label}}}}),angular.module("carnival.components.listingFieldFile",[]).directive("carnivalListingFieldFile",function(){return{restrict:"E",replace:!0,scope:{item:"=",field:"="},templateUrl:"components/listing-field-file/listing-field-file.html",controller:["$scope",function(a){a.checkIfIsImage=function(a){return/\.(gif|jpg|jpeg|tiff|png)$/i.test(a)}}]}}),angular.module("carnival.components.listingfieldhasmany",[]).directive("carnivalListingFieldHasMany",function(){return{restrict:"E",replace:!0,scope:{item:"=",field:"="},templateUrl:"components/listing-field-has-many/listing-field-has-many.html",controller:["$scope","$stateParams","Configuration","urlParams",function(a,b,c){var d=c.getEntity(b.entity),e=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(("belongsTo"===c.type||"hasMany"===c.type)&&c.entityName===d.name)return c}return null};a.getLabel=function(){return"View "+a.field.label},a.getUrl=function(){var b=c.getEntity(a.field.entityName),f=e(b.fields);return"#/list/"+a.field.endpoint+"?page=1&search."+f.foreignKey+"="+a.item[d.identifier]}}]}}),angular.module("carnival.components.listingfield",[]).directive("carnivalListingField",function(){return{restrict:"E",replace:!0,scope:{item:"=",field:"="},templateUrl:"components/listing-field/listing-field.html"}}),angular.module("carnival.components.listing",[]).directive("carnivalListing",function(){return{restrict:"E",replace:!0,scope:{fields:"=",datas:"=",actions:"=",extraActions:"=",identifier:"=",entityName:"="},templateUrl:"components/listing/listing.html"}}),angular.module("carnival.components.navbar",[]).directive("carnivalNavbar",function(){return{restrict:"E",replace:!0,scope:{appName:"=",menuItems:"="},templateUrl:"components/navbar/navbar.html",controller:["$scope","$stateParams","urlParams","$location",function(a,b,c,d){var e="#";d.$$html5&&(e=""),a.buildUrl=function(a){return"entity"===a.type?e+"/list/"+a.url:"url"===a.type?a.url:"#"},a.checkSelEntity=function(c){return"entity"===a.menuItems[c].link.type&&a.menuItems[c].link.url===b.entity?!0:!1}}]}}),angular.module("carnival.components.nested-form-area",[]).directive("carnivalNestedFormArea",function(){return{restrict:"E",replace:!0,scope:{entity:"=",field:"=",state:"@",datas:"=",relationType:"@",editable:"="},templateUrl:"components/nested-form/nested-form-area.html",controller:["$rootScope","$scope","$timeout","utils","$element","$compile","FormService","Configuration","EntityResources",function(a,b,c,d,e,f,g,h,i){b.canOpenNestedForm=function(){return b.entity.nestedForms[b.field.endpoint]?"create"===b.state?!1:!0:!1},b.openNestedForm=function(a,d,e,h){if(g.isNestedOpen(b.field.entityName))return g.closeNested(b.field.entityName),void c(function(){b.openNestedForm(a,d,e,h)},200);g.openNested(b.field.entityName),a.parentEntity=b.entity,b.nestedEntity=a,a.datas=d;var i='<carnival-nested-form state="'+e+'" type="nested" entity="nestedEntity"></carnival-nested-form></div>',j=f(i)(b),k=document.querySelector(h);angular.element(k).append(j)},b.openWithData=function(a){var c="#edit_nested_"+b.field.entityName+"_"+a[b.field.identifier],d="edit",e=i.prepareForEditState(b.field.entityName),f=e.identifier;e[f]=a[f],b.openNestedForm(e,a,d,c)},b.open=function(){var a="#create_nested_"+b.field.entityName,c=b.entity.nestedForms[b.field.endpoint];b.openNestedForm(c,{},"create",a)},b.isHasMany=function(){return"hasMany"===b.relationType};var j=function(a,b){for(var c=0;c<b.length;c++)if(b[c].id===a)return c;return-1},k=function(a){if(b.field.views[b.state].enableDelete){var c=h.getEntity(b.field.entityName);c["delete"](a).success(function(){new Notification("Item deleted with success!","warning")}).error(function(a){new Notification(a,"danger")})}};b.remove=function(a){var c=b.datas[b.field.name],d=j(a,c);0>d||(c.splice(d,1),k(a))}}]}}),angular.module("carnival.components.nested-form",[]).directive("carnivalNestedForm",function(){return{restrict:"E",replace:!0,scope:{entity:"=",state:"@",editable:"="},templateUrl:"components/nested-form/nested-form.html",controller:["$rootScope","$scope","utils","$element","FormService",function(a,b,c,d,e){b.isClosed=function(){return!e.nesteds[b.entity.name]},b.close=function(){e.closeNested(b.entity.name)},b.$watch("isClosed()",function(a,b){a!==b&&a&&d.remove()})}]}}),angular.module("carnival.components.notification",[]).directive("carnivalNotification",function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"components/notification/notification.html",controller:["$scope","notificationFactory",function(a,b){a.notifications=b}]}}),angular.module("carnival.components.order-controller",[]).directive("carnivalOrderCtrl",function(){return{restrict:"E",replate:!0,scope:{field:"="},templateUrl:"components/order-controller/order-controller.html",controller:["$scope","urlParams",function(a,b){a.toggleOrder=function(){var c=b.getParam("order")!==a.field?"asc":"asc"===b.getParam("orderDir")&&b.getParam("order")===a.field?"desc":"asc";b.setParam("order",a.field),b.setParam("orderDir",c),b.reload()},a.checkDirAsc=function(){return b.getParam("order")===a.field&&"asc"===b.getParam("orderDir")?!0:!1}}]}}),angular.module("carnival.components.pagination-controller",[]).directive("carnivalPaginationCtrl",function(){return{restrict:"E",replace:!0,scope:{currentPage:"=",totalPages:"="},templateUrl:"components/pagination-controller/pagination-controller.html",controller:["$scope","$rootScope","urlParams",function(a,b,c){a.jumpTo=function(a){c.setParam("page",a,!0)},a.nextPage=function(){a.currentPage!==a.totalPages&&c.setParam("page",a.currentPage+1,!0)},a.prevPage=function(){1!==a.currentPage&&c.setParam("page",a.currentPage-1,!0)},b.$on("paramsChange",function(){a.currentPage=parseInt(c.getParam("page"),10)})}]}}),angular.module("carnival.components.quickfilter-controller",[]).directive("carnivalQuickFilter",function(){return{restrict:"E",replace:!0,scope:{filters:"="},templateUrl:"components/quickfilter-controller/quickfilter-controller.html",controller:["$scope","urlParams",function(a,b){a.isSelected=function(a,c){return c===b.getParam("search."+a)},a.setFilter=function(a,c){b.setParam("search."+a,c,!0)}}]}}),angular.module("carnival.components.search-controller",[]).directive("carnivalSearchCtrl",function(){return{restrict:"E",replace:!0,scope:{fields:"=",relatedResources:"="},templateUrl:"components/search-controller/search-controller.html",controller:["$scope","urlParams",function(a,b){var c=function(){a.searchParams={};for(var c=0,d=a.fields.length;d>c;c+=1){var e=a.fields[c].name;"belongsTo"===a.fields[c].type&&(e=a.fields[c].foreignKey),a.searchParams[e]=b.getParam("search."+e)}};a.submit=function(){for(var c=Object.keys(a.searchParams),d=0,e=c.length;e>d;d+=1)b.setParam("search."+c[d],a.searchParams[c[d]]);b.emitLoadEvent()},c()}]}}),angular.module("carnival.components.uploader",[]).directive("carnivalUploader",function(){return{restrict:"E",replace:!0,scope:{uploader:"=",fileUrl:"="},templateUrl:"components/uploader/uploader.html",controller:["$scope","$http","Uploader","Notification","Configuration",function(a,b,c,d,e){var f=function(){if(a.uploader.endpoint&&a.uploader.endpointUrl)throw"Set only one type of endpoint for the uploader";return a.uploader.endpoint?e.getBaseApiUrl()+"/"+a.uploader.endpoint:a.uploader.endpointUrl};a.upload=function(){c.upload(f(),a.files[0]).success(function(b){new d("File uploaded with success","success"),a.fileUrl=a.uploader.getUrl(b)}).error(function(a){new d(a,"warning")})}}]}}).directive("fileInput",["$parse",function(a){return{restrict:"A",link:function(b,c,d){c.bind("change",function(){a(d.fileInput).assign(b,c[0].files),b.$apply()})}}}]),angular.module("carnival").provider("Configuration",["$stateProvider",function(a){var b=null,c=null,d=!1,e=[],f=[],g=[];return{setBaseApiUrl:function(a){a.replace(/\/$/,""),c=a},setAppName:function(a){b=a},validateEntities:function(a){a&&(d=!0)},setEntities:function(a){a=a},addEntity:function(a,b){e.push({name:a,options:b})},addNavbarItem:function(a){f.push(a)},addState:function(a){g.push(a)},$get:function(){return{entities:e,validateEntities:d,getBaseApiUrl:function(){return c},getAppName:function(){return b},getEntity:function(a){for(var b=0,c=e.length;c>b;b+=1)if(e[b].name===a)return e[b];return"Entity not found!"},getEntities:function(){return e},addExtraStates:function(){for(var b=0;b<g.length;b++){var c=g[b];a.state("main."+c.name,{url:c.url,templateUrl:c.templateUrl,controller:c.controller})}},getNavbarItems:function(){return f}}}}}]),angular.module("carnival").factory("Entity",["EntityValidation","$http","Configuration","RequestBuilder","FieldBuilder",function(a,b,c,d,e){function f(b,d){c.validateEntities&&a(b,d),this.name=b,this.endpoint=d.endpoint||this.name,this.label=d.label||this.name,this.identifier=d.identifier,this.extraReqParams=d.extraReqParams||{},this.quickFilters=d.quickFilters||null,this.pagination=d.pagination||null,this.fields=[],g(d.fields,this),h(d.extraActions,this)}var g=function(a,b){var c=[];Object.keys(a).forEach(function(b){var d=e.build(b,a[b]);c.push(d)}),b.fields=c},h=function(a,b){if(b.extraActions=[],a)for(var c in a){var d={name:c,url:a[c].url,label:a[c].label};b.extraActions.push(d)}};return f.prototype.checkFieldView=function(a,b){for(var c=0,d=this.fields.length;d>c;c+=1)if(this.fields[c].name===a)return this.fields[c].views[b]&&this.fields[c].views[b].enable;return!1},f.prototype.getFieldByEntityName=function(a){for(var b=0;b<this.fields.length;b++)if(this.fields[b].entityName===a)return this.fields[b]},f.prototype.getList=function(a,b,e,f,g){var h=this.extraReqParams.list||{},i=d.buildForGetList({baseUrl:c.getBaseApiUrl(),extraParams:h,offset:a,entity:this,limit:b,order:e,orderDir:f,search:g,endpoint:this.endpoint});return this.request(i)},f.prototype.getOne=function(a){var b=this.extraReqParams.show||{},e=d.buildForGetOne({baseUrl:c.getBaseApiUrl(),extraParams:b,id:a,endpoint:this.endpoint});return this.request(e)},f.prototype["delete"]=function(a){var b=this.extraReqParams["delete"]||{},e=d.buildForDelete({baseUrl:c.getBaseApiUrl(),extraParams:b,id:a,endpoint:this.endpoint});return this.request(e)},f.prototype.create=function(a){var b=this.extraReqParams.create||{},e=d.buildForCreate({baseUrl:c.getBaseApiUrl(),extraParams:b,entity:this,entityData:a,endpoint:this.endpoint});return this.request(e)},f.prototype.update=function(a,b){var e=this.extraReqParams.update||{},f=d.buildForUpdate({baseUrl:c.getBaseApiUrl(),extraParams:e,id:a,entity:this,entityData:b,endpoint:this.endpoint});return this.request(f)},f.prototype.request=function(a){return b(a)},f}]),angular.module("carnival").factory("EntityValidation",function(){var a=function(a,b){if(!a)throw"You must set a name for your entity";if(!b.identifier)throw"You must set an identifier for the entity "+a;if(!b.fields)throw"You must set the fields for the entity "+this.name};return a}),angular.module("carnival").service("ActionFactory",["Notification","$state","ParametersParser","EntityUpdater",function(a,b,c){this.buildCreateFunction=function(d,e,f){return function(g){d.model.create(c.parse(d.datas,d)).success(function(c){g?g(!1,c):f||(new a("Item created with success!","success"),e?b.go("main.edit",{entity:d.model.name,id:c.id}):b.go("main.list",{entity:d.model.name}))}).error(function(b){new a(b,"danger"),g&&g(!0,b)})}},this.buildEditFunction=function(d){return function(e){d.model.update(d.id,c.parse(d.datas,d)).success(function(){e?e(!1,d.datas):(new a("Modifications saved with success!","success"),b.go("main.show",{entity:d.model.name,id:d.id}))}).error(function(b){new a(b,"danger"),e(!0,b)})}},this.buildShowFunction=function(a){return function(){b.go("main.edit",{entity:a.model.name,id:a.id})}},this.buildListFunction=function(c){var d=function(){b.go("main.create",{entity:c.name})},e=function(a){b.go("main.edit",{entity:c.name,id:a})},f=function(a){b.go("main.show",{entity:c.name,id:a})},g=function(d){c.model["delete"](d).success(function(){new a("Item deleted with success!","warning"),b.reload()}).error(function(b){new a(b,"danger")})};return{create:d,edit:e,show:f,"delete":g}},this.buildAction=function(a,b,c){switch(b){case"create":return{name:"action",value:{label:"Save",click:this.buildCreateFunction(a,Object.keys(a.nestedForms).length>0,c)}};case"edit":return{name:"action",value:{label:"Save",click:this.buildEditFunction(a)}};case"show":return{name:"action",value:{label:"Edit",click:this.buildShowFunction(a)}};case"index":return{name:"actions",value:this.buildListFunction(a)};default:return{}}}}]),angular.module("carnival").service("FieldBuilder",function(){var a=function(a){var b={};return Object.keys(a).forEach(function(c){var d=a[c];b[c]={enable:d.enable,searchable:"boolean"==typeof d.searchable?d.searchable:!0,showOptions:d.showOptions||!1,enableDelete:d.enableDelete||!1,nested:d.nested||!1,sortable:"boolean"==typeof d.sortable?d.sortable:!0}}),b},b=function(a){return a.charAt(0).toUpperCase()+a.substring(1)},c=function(a){return"belongsTo"===a.type||"hasMany"===a.type?a.foreignKey?a.foreignKey:a.identifier?a.name+b(a.identifier):a.name:void 0};this.build=function(b,d){var e={name:b,label:d.label,foreignKey:d.foreignKey,endpoint:d.endpoint||b,field:d.field,identifier:d.identifier||"id",entityName:d.entityName||b,type:d.type,uploader:d.uploader,gallery:d.gallery,values:d.values,currencyOptions:d.currencyOptions,views:a(d.views)};return e.foreignKey=c(e),e}}),angular.module("carnival").service("EntityResources",["Configuration","ActionFactory",function(a,b){var c=this,d=function(a,b,c){c.views[b]&&c.views[b].nested&&(a.nestedForms[c.endpoint]=k(c.endpoint,"create",a),a.nestedForms[c.endpoint].parentEntity=a)},e=function(b,c){var d=a.getEntity(c);d.getList().success(function(a){b.relatedResources[c]=a})},f=function(a,b){return("edit"===a||"create"===a||"index"===a)&&g(b)},g=function(a){return"belongsTo"===a||"hasMany"===a},h=function(a,b,g,h){a.model.checkFieldView(g.name,b)&&(a.fields.unshift(g),f(b,g.type)&&(e(a,g.endpoint),(!h||g.entityName!==c.entityName&&c.entityName===h.name)&&d(a,b,g)))},i=function(a,b,c){a.relatedResources={};for(var d=a.model.fields.length-1;d>=0;d-=1){var e=a.model.fields[d];h(a,b,e,c)}},j=function(a,c,d){var e=b.buildAction(a,c,d);a[e.name]=e.value},k=function(b,c,d){var e={};return e.nestedForms={},e.model=a.getEntity(b),e.name=e.model.name,e.label=e.model.label,e.identifier=e.model.identifier,e.fields=[],e.extraActions=e.model.extraActions,e.datas={},i(e,c,d),j(e,c,d),e};this.prepareForState=function(a,b){return this.entityName=a,k(a,b)},this.prepareForCreateState=function(a){return this.prepareForState(a,"create")},this.prepareForEditState=function(a){return this.prepareForState(a,"edit")},this.prepareForShowState=function(a){return this.prepareForState(a,"show")},this.prepareForListState=function(a){return this.prepareForState(a,"index")}}]),angular.module("carnival").service("EntityUpdater",function(){var a=function(a,b,c){for(var d=a.datas[b.name],e=0;e<d.length;e++){var f=d[e];if(f[b.identifier]===c[b.identifier])return!0}return!1},b=function(a,b,c){d(a,b,c,a.datas[b.name])},c=function(a,b,c){d(a,b,c,a.relatedResources[b.endpoint])},d=function(a,b,c,d){for(var e=0;e<d.length;e++){var f=d[e];if(f[b.identifier]===c[b.identifier]){for(var g in f)f[g]=c[g];break}}},e=function(d,e,f){var g=d.datas[e.name];a(d,e,f)?(b(d,e,f),c(d,e,f)):(g.push(f),d.relatedResources[e.endpoint].push(f))};this.updateEntity=function(a,b,c){"belongsTo"===b.type?(a.datas[b.name]=c,a.relatedResources[b.endpoint].push(c)):"hasMany"===b.type&&(a.datas[b.name]||(a.datas[b.name]=[]),e(a,b,c))}}),angular.module("carnival").service("FormService",["Configuration","ActionFactory",function(a){this.nesteds={},this.init=function(a){this.entity=a,this.nesteds={}},this.openNested=function(a){this.nesteds[a]||(this.nesteds[a]={});var b=this.nesteds[a];b.saved=!1},this.saveNested=function(a){var b=this.nesteds[a];b.saved=!0},this.hasUnsavedNested=function(){for(var a in this.nesteds){var b=this.nesteds[a];if(!b.saved)return!0}return!1},this.isNestedOpen=function(a){return this.nesteds[a]?!0:!1},this.closeNested=function(a){delete this.nesteds[a]};var b=function(a){return"hasMany"!=a.type&&"belongsTo"!=a.type?!1:!0};this.canShowThisField=function(a,c,d){return b(d)?a.parentEntity&&a.parentEntity.name===d.entityName?!1:"create"===c&&"hasMany"===d.type?this.canShowThisHasManyField(a,c,d):!0:!0},this.canShowThisHasManyField=function(b,c,d){var e=a.getEntity(d.entityName),f=e.getFieldByEntityName(b.name);return"belongsTo"!==f.type||d.views[c].showOptions?!0:!1}}]),angular.module("carnival").provider("HttpAdapter",function(){var a={getList:null};return{getList:function(b){a.getList=b},getOne:function(b){a.getOne=b},$get:function(){return a}}}),angular.module("carnival").config(["$httpProvider",function(a){a.interceptors.push(["$q","$cacheFactory","$timeout","$rootScope","loadingBar",function(b,c,d,e,f){function g(){d.cancel(i),f.complete(),k=0,j=0}function h(b){var d,e=c.get("$http"),f=a.defaults;!b.cache&&!f.cache||b.cache===!1||"GET"!==b.method&&"JSONP"!==b.method||(d=angular.isObject(b.cache)?b.cache:angular.isObject(f.cache)?f.cache:e);var g=void 0!==d?void 0!==d.get(b.url):!1;return void 0!==b.cached&&g!==b.cached?b.cached:(b.cached=g,g)}var i,j=0,k=0;return{request:function(a){return a.ignoreLoadingBar||h(a)||(e.$broadcast("loadingBar.loading",{url:a.url}),0===j&&(i=d(function(){f.start()},f.latency)),j++,f.set(k/j)),a},response:function(a){return a.config.ignoreLoadingBar||h(a.config)||(k++,e.$broadcast("loadingBar.loaded",{url:a.config.url,result:a}),k>=j?g():f.set(k/j)),a},responseError:function(a){return a.config.ignoreLoadingBar||h(a.config)||(k++,e.$broadcast("loadingBar.loaded",{url:a.config.url,result:a}),k>=j?g():f.set(k/j)),b.reject(a)}}}])}]),angular.module("carnival").provider("loadingBar",function(){return{latency:100,size:.02,parent:"body",template:'<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',$get:["$injector","$document","$timeout","$rootScope",function(a,b,c,d){function e(){j||(j=a.get("$animate"));var e=b.find(m).eq(0);c.cancel(l),p||(d.$broadcast("loadingbar.started"),p=!0,j.enter(n,e),f(r))}function f(a){if(p){var b=100*a+"%";o.css("width",b),q=a,c.cancel(k),k=c(function(){g()},200)}}function g(){if(!(q>=1)){var a=0;a=q>=0&&.25>q?(3*Math.random()+3)/100:q>=.25&&.65>q?3*Math.random()/100:q>=.65&&.9>q?2*Math.random()/100:q>=.9&&.99>q?.005:0;var b=q+a;f(b)}}function h(){q=0,p=!1}function i(){j||(j=a.get("$animate")),d.$broadcast("loadingBar.completed"),f(1),c.cancel(l),l=c(function(){var a=j.leave(n,h);a&&a.then&&a.then(h)},500)}var j,k,l,m=this.parent,n=angular.element(this.template),o=n.find("div").eq(0),p=!1,q=0,r=this.size;return{start:e,set:f,status:q,inc:g,complete:i,latency:this.latency}}]}}),angular.module("carnival").factory("notificationFactory",function(){var a=[];return a}),angular.module("carnival").service("Notification",["$timeout","notificationFactory",function(a,b){function c(c,e){this.message=c,this.type=e,b.unshift(this),a(d,3e3)}var d=function(){b.splice(b.length-1,1)};return c}]),angular.module("carnival").service("RequestBuilder",["HttpAdapter",function(){var a=function(a,c){var d={};return d.params={},d.method=a,b(d,c.extraParams),d},b=function(a,b){if(b)for(var c in b)a.params[c]=b[c]};this.buildForGetList=function(b){var c=a("GET",b);return c.url=b.baseUrl+"/"+b.endpoint,c.params.offset=b.offset,c.params.limit=b.limit,b.order&&b.orderDir&&(c.params.order=b.order,c.params.orderDir=b.orderDir),b.search&&(c.params.search=encodeURIComponent(JSON.stringify(b.search))),c},this.buildForGetOne=function(b){var c=a("GET",b);return c.url=b.baseUrl+"/"+b.endpoint+"/"+b.id,c},this.buildForDelete=function(b){var c=a("DELETE",b);return c.url=b.baseUrl+"/"+b.endpoint+"/"+b.id,c},this.buildForCreate=function(b){var c=a("POST",b);return c.url=b.baseUrl+"/"+b.endpoint,c.data=b.entityData,c},this.buildForUpdate=function(b){var c=a("PUT",b);return c.url=b.baseUrl+"/"+b.endpoint+"/"+b.id,c.data=b.entityData,c}}]),angular.module("carnival").service("ParametersParser",function(){var a=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];
if(d.name===a)return d}return null},b=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.entityName===a)return d}return null},c=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(e[a.identifier])}return c},d=function(a){var d={},e=a.parentEntity;if(!e)return d;var f=b(e.name,a.fields);return f?("hasMany"===f.type?d[f.name]=c(f,[e.datas]):"belongsTo"===f.type&&(d[f.foreignKey]=e.datas[f.identifier]),d):{}};this.parse=function(b,e){var f={};for(var g in b){var h=a(g,e.fields);f[g]=h&&"hasMany"==h.type?c(h,b[g]):b[g]}var i=d(e);return angular.extend(f,i)}}),angular.module("carnival").service("Uploader",["$http","Configuration",function(a){var b=function(b,c){var d=new FormData;return d.append("file",c),a.post(b,d,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})};return{upload:b}}]),angular.module("carnival").service("urlParams",["$rootScope","$location","$state",function(a,b){this.defaultParams={page:1},this.setParam=function(a,c,d){""===c&&(c=null),b.search(a,c),d&&this.emitLoadEvent()},this.getParam=function(a){var c=b.search()[a];return!isNaN(parseInt(c))&&isFinite(c)?parseInt(c,10):c||this.defaultParams[a]},this.getAllParams=function(){return b.search()},this.clearParams=function(){Object.keys(b.search()).forEach(function(a){b.search(a,null)})},this.emitLoadEvent=function(){a.$broadcast("paramsChange")},this.reload=this.emitLoadEvent}]),angular.module("carnival").service("utils",function(){var a=function(a,b){if(!b)return a;if(!a)throw"cutString: to cut a string you must pass a string!";return a.length<=b?a:"string"!=typeof a?a:a=a.substr(0,b-1)+"..."};return{cutString:a}}),angular.module("carnival").controller("CreateController",["$scope","$stateParams","$state","Configuration","Notification","EntityResources",function(a,b,c,d,e,f){var g=a.entity={},h=function(){a.entity=f.prepareForCreateState(b.entity),g=a.entity};h()}]),angular.module("carnival").controller("EditController",["$rootScope","$scope","$stateParams","$state","Configuration","EntityResources",function(a,b,c,d,e,f){var g=b.entity={},h=function(){b.entity=g=f.prepareForEditState(c.entity),g.model.getOne(c.id).success(function(a){g.id=c.id,g.datas=a})};h()}]),angular.module("carnival").controller("ListController",["$rootScope","$scope","$stateParams","$state","Configuration","Notification","urlParams","EntityResources",function(a,b,c,d,e,f,g,h){var i=b.entity={},j=b.pages={current:parseInt(g.getParam("page"),10)},k=function(){d.go("main.create",{entity:i.name})},l=function(a){d.go("main.edit",{entity:i.name,id:a})},m=function(a){d.go("main.show",{entity:i.name,id:a})},n=function(a){i.model["delete"](a).success(function(){new f("Item deleted with success!","warning"),d.reload()}).error(function(a){new f(a,"danger")})},o=function(){for(var a={},b=0,c=i.fields.length;c>b;b+=1){var d=i.fields[b].name;"belongsTo"===i.fields[b].type&&(d=i.fields[b].foreignKey),a[d]=g.getParam("search."+d)}return 0===Object.keys(a).length?!1:a},p=function(){i=h.prepareForListState(c.entity),i.loadData=function(){var a=j.perPage*(g.getParam("page")-1),b=j.perPage;i.model.getList(a,b,g.getParam("order"),g.getParam("orderDir"),o()).success(function(a,b,c){j.total=Math.ceil(c("X-Total-Count")/j.perPage),i.datas=a})},b.entity=i,j.perPage=i.model.pagination,i.actions={create:k,edit:l,show:m,"delete":n},i.loadData()};a.$on("paramsChange",function(){i.loadData()}),p()}]),angular.module("carnival").controller("ShowController",["$scope","$stateParams","$state","Configuration","EntityResources",function(a,b,c,d,e){var f=a.entity={};a.buttonAction=function(){c.go("main.edit",{entity:f.name,id:f.datas.id})},a.getValue=function(a,b){for(var c=0,d=b.values.length;d>c;c+=1)if(b.values[c].value===a)return b.values[c].label};var g=function(){f=a.entity=e.prepareForShowState(b.entity),f.model.getOne(b.id).success(function(a){f.datas=a})};g()}]),angular.module("carnival").controller("MainController",["$scope","Configuration",function(a,b){a.app_name=b.getAppName(),a.menu_items=b.getNavbarItems()}]),angular.module("carnival.templates",["components/button/button.html","components/delete-button/delete-button.html","components/fields/belongs-to/belongs-to.html","components/fields/boolean/boolean.html","components/fields/currency/currency.html","components/fields/date/date.html","components/fields/enum/enum.html","components/fields/file/file.html","components/fields/has-many/has-many.html","components/fields/number/number.html","components/fields/select/select.html","components/fields/string/string.html","components/fields/text/text.html","components/fields/wysiwyg/wysiwyg.html","components/form/form.html","components/gallery/gallery.html","components/listing-extra-action/listing-extra-action.html","components/listing-field-belongs-to/listing-field-belongs-to.html","components/listing-field-currency/listing-field-currency.html","components/listing-field-enum/listing-field-enum.html","components/listing-field-file/listing-field-file.html","components/listing-field-has-many/listing-field-has-many.html","components/listing-field/listing-field.html","components/listing/listing.html","components/navbar/navbar.html","components/nested-form/nested-form-area.html","components/nested-form/nested-form.html","components/notification/notification.html","components/order-controller/order-controller.html","components/pagination-controller/pagination-controller.html","components/quickfilter-controller/quickfilter-controller.html","components/search-controller/search-controller.html","components/uploader/uploader.html","states/main.create/create.html","states/main.edit/edit.html","states/main.list/list.html","states/main.show/show.html","states/main/main.html"]),angular.module("components/button/button.html",[]).run(["$templateCache",function(a){a.put("components/button/button.html",'<a class="btn btn-{{ style }} btn-{{ size }}">{{ label }}</a>')}]),angular.module("components/delete-button/delete-button.html",[]).run(["$templateCache",function(a){a.put("components/delete-button/delete-button.html",'<span>\n  <a ng-hide="isDeleting" class="btn btn-danger btn-xs" ng-click="start()">{{ \'Delete\' | translate }}</a>\n  <a ng-show="isDeleting" class="btn btn-default btn-xs" ng-click="cancel()">{{ \'Cancel\' | translate }}</a>\n  <a ng-show="isDeleting" class="btn btn-danger btn-xs" ng-click="confirm()">{{ \'Confirm\' | translate }}</a>\n</span>\n')}]),angular.module("components/fields/belongs-to/belongs-to.html",[]).run(["$templateCache",function(a){a.put("components/fields/belongs-to/belongs-to.html",'<div>\n  <carnival-select-field data="datas[field.foreignKey]" field="field.field" identifier="field.identifier" items="relatedResources[field.endpoint]" editable="editable">\n\n  </carnival-select-field>\n  <carnival-nested-form-area state="{{state}}" entity="entity" field="field" datas="datas" relation-type="belongsTo"></carnival-nested-form-area>\n\n</div>\n')}]),angular.module("components/fields/boolean/boolean.html",[]).run(["$templateCache",function(a){a.put("components/fields/boolean/boolean.html",'<input type="checkbox" ng-model="data"></input>\n')}]),angular.module("components/fields/currency/currency.html",[]).run(["$templateCache",function(a){a.put("components/fields/currency/currency.html",'<div>\n  <input class="form-control" type="text" ng-model="data" currency></input>\n</div>\n')}]),angular.module("components/fields/date/date.html",[]).run(["$templateCache",function(a){a.put("components/fields/date/date.html",'<div>\n  <input type="datetime" date-time ng-model="data" view="date" ></input>\n</div>\n')}]),angular.module("components/fields/enum/enum.html",[]).run(["$templateCache",function(a){a.put("components/fields/enum/enum.html",'<div>\n  <carnival-select-field data="data" field="\'label\'" identifier="\'value\'" items="field.values" editable="true"></carnival-select-field>\n</div>\n')}]),angular.module("components/fields/file/file.html",[]).run(["$templateCache",function(a){a.put("components/fields/file/file.html",'<div>\n  <div>\n    <img ng-if="checkIfIsImage(data)" ng-src="{{ data }}" width="200" height="120"/>\n    <a ng-if="!checkIfIsImage(data)" href="{{ data }}">{{ data }}</a>\n  </div>\n  <div ng-if="editable">\n    <carnival-string-field label="field.label" data="$parent.data" editable="editable"></carnival-string-field>\n    <div ng-if="checkIfHasUploader()">\n      <carnival-uploader uploader="field.uploader" file-url="$parent.$parent.data"></carnival-uploader>\n    </div>\n    <div ng-if="checkIfHasGallery()">\n      <carnival-gallery gallery="field.gallery" file-url="$parent.$parent.data"></carnival-gallery>\n    </div>\n  </div>\n</div>\n')}]),angular.module("components/fields/has-many/has-many.html",[]).run(["$templateCache",function(a){a.put("components/fields/has-many/has-many.html",'<div>\n  <span ng-show=\'canShow()\' >\n    <select ng-model="selectedHasMany" ng-options="item[field.identifier] as utils.cutString(item[field.field], 25) for item in relatedResources[field.endpoint]">\n    </select>\n    <a class="btn btn-default btn-xs" ng-click="addHasManyOption()">Add</a>\n  </span>\n\n  <carnival-nested-form-area state="{{state}}" entity="entity" field="field" datas="datas" relation-type="hasMany"></carnival-nested-form-area>\n</div>\n')}]),angular.module("components/fields/number/number.html",[]).run(["$templateCache",function(a){a.put("components/fields/number/number.html",'<input class="form-control" type="number" placeholder="{{ label }}" ng-model="data"></input>\n')}]),angular.module("components/fields/select/select.html",[]).run(["$templateCache",function(a){a.put("components/fields/select/select.html",'<select ng-model="data" ng-options="item[identifier] as utils.cutString(item[field], 25) for item in items">\n</select>\n')}]),angular.module("components/fields/string/string.html",[]).run(["$templateCache",function(a){a.put("components/fields/string/string.html",'<input class="form-control" type="text" placeholder="{{ label }}" ng-model="data"></input>\n')}]),angular.module("components/fields/text/text.html",[]).run(["$templateCache",function(a){a.put("components/fields/text/text.html",'<textarea class="form-control" placeholder="{{ label }}" ng-model="data"></textarea>\n')}]),angular.module("components/fields/wysiwyg/wysiwyg.html",[]).run(["$templateCache",function(a){a.put("components/fields/wysiwyg/wysiwyg.html",'<div>\n  <div text-angular ng-model="data"></div>\n</div>\n')}]),angular.module("components/form/form.html",[]).run(["$templateCache",function(a){a.put("components/form/form.html",'<form class="simple-form form-horizontal" ng-init="nestedFormIndex = {value: 0}" novalidate>\n  <div class="form-group" ng-repeat="field in fields">\n    <label ng-if=\'canShow(field)\' class="col-sm-2 control-label">{{ field.label }}</label>\n    <div class="col-sm-10" ng-switch="field.type">\n      <!-- Fields -->\n      <carnival-text-field ng-switch-when="text" data="datas[field.name]" label="field.label" editable="editable"></carnival-text-field>\n      <carnival-wysiwyg-field ng-switch-when="wysiwyg" data="datas[field.name]" label="field.label" editable="editable"></carnival-wysiwyg-field>\n      <carnival-boolean-field ng-switch-when="boolean" data="datas[field.name]" editable="editable"></carnival-boolean-field>\n      <carnival-string-field ng-switch-when="string" data="datas[field.name]" label="field.label" editable="editable"></carnival-string-field>\n      <carnival-number-field ng-switch-when="number" data="datas[field.name]" label="field.label" editable="editable"></carnival-number-field>\n      <carnival-date-field ng-switch-when="date" data="datas[field.name]" editable="editable"></carnival-date-field>\n      <carnival-file-field ng-switch-when="file" data="datas[field.name]" field="field" editable="editable"></carnival-file-field>\n      <carnival-enum-field ng-switch-when="enum" data="datas[field.name]" field="field"></carnival-enum-field>\n      <carnival-currency-field ng-switch-when="currency" data="datas[field.name]" field="field"></carnival-currency-field>\n      <carnival-belongs-to-field ng-if=\'canShow(field)\' ng-switch-when="belongsTo" nested-form-index="nestedFormIndex" entity="entity" field="field" datas="entity.datas" action="entity.action" related-resources="entity.relatedResources" state="{{state}}"  editable="true"></carnival-belongs-to-field>\n      <carnival-has-many-field ng-if=\'canShow(field)\' ng-switch-when="hasMany" entity="entity" nested-form-index="nestedFormIndex" field="field" datas="entity.datas" action="entity.action" related-resources="entity.relatedResources" state="{{state}}" editable="true"></carnival-has-many-field>\n      <carnival-text-field ng-switch-default data="datas[field.name]" label="field.label" editable="editable"></carnival-text-field>\n    </div>\n  </div>\n  <label class="col-sm-2 control-label">\n    <carnival-button label="{{ action.label | translate }}" style="success" size="sm" ng-click="buttonAction()"></carnival-button>\n  </label>\n</form>\n')}]),angular.module("components/gallery/gallery.html",[]).run(["$templateCache",function(a){a.put("components/gallery/gallery.html",'<div>\n  <carnival-button label="Open Gallery" style="default" size="sm" ng-click="open()"></carnival-button>\n</div>\n')}]),angular.module("components/listing-extra-action/listing-extra-action.html",[]).run(["$templateCache",function(a){a.put("components/listing-extra-action/listing-extra-action.html","<span>\n<a class=\"btn btn-default btn-xs\" ng-href='{{getUrl()}}'>{{ getLabel() }}</a>\n</span>\n")}]),angular.module("components/listing-field-belongs-to/listing-field-belongs-to.html",[]).run(["$templateCache",function(a){a.put("components/listing-field-belongs-to/listing-field-belongs-to.html",'<span>\n  <a href="{{ getUrl() }}">{{ getLabel() }}</a>\n</span>\n')}]),angular.module("components/listing-field-currency/listing-field-currency.html",[]).run(["$templateCache",function(a){a.put("components/listing-field-currency/listing-field-currency.html","<div>\n  {{ toCurrency(item[field.name]) }}\n</div>\n")}]),angular.module("components/listing-field-enum/listing-field-enum.html",[]).run(["$templateCache",function(a){a.put("components/listing-field-enum/listing-field-enum.html","<div>\n  {{ getValue(item[field.name]) }}\n</div>\n")}]),angular.module("components/listing-field-file/listing-field-file.html",[]).run(["$templateCache",function(a){a.put("components/listing-field-file/listing-field-file.html",'<div>\n  <img ng-if="checkIfIsImage(item[field.name])" ng-src="{{ item[field.name] }}" width="200" height="120"/>\n  <a ng-if="!checkIfIsImage(item[field.name])" href="{{ item[field.name] }}">{{ item[field.name] }}</a>\n</div>\n')}]),angular.module("components/listing-field-has-many/listing-field-has-many.html",[]).run(["$templateCache",function(a){a.put("components/listing-field-has-many/listing-field-has-many.html",'<span>\n  <a href="{{ getUrl() }}">{{ getLabel() }}</a>\n</span>\n')}]),angular.module("components/listing-field/listing-field.html",[]).run(["$templateCache",function(a){a.put("components/listing-field/listing-field.html",'<span ng-switch="field.type">\n  <carnival-listing-field-belongs-to ng-switch-when="belongsTo" item="item" field="field"></carnival-listing-field-belongs-to>\n  <carnival-listing-field-has-many ng-switch-when="hasMany" item="item" field="field"></carnival-listing-field-has-many>\n  <carnival-listing-field-file ng-switch-when="file" item="item" field="field"></carnival-listing-field-file>\n  <carnival-listing-field-enum ng-switch-when="enum" item="item" field="field"></carnival-listing-field-enum>\n  <carnival-listing-field-currency ng-switch-when="currency" item="item" field="field"></carnival-listing-field-currency>\n  <span ng-switch-default>\n    {{item[field.name]}}\n  </span>\n</span>\n')}]),angular.module("components/listing/listing.html",[]).run(["$templateCache",function(a){a.put("components/listing/listing.html",'<table class="table table-hover">\n  <thead>\n    <tr>\n      <th ng-repeat="field in fields">\n        {{ field.label }}\n        <carnival-order-ctrl field="field.name"></carnival-order-ctrl>\n      </th>\n      <th ng-if="actions" style="width: 30%">\n        {{ \'Actions\' | translate }}\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="data in datas">\n      <td ng-repeat="field in fields">\n        <carnival-listing-field item="data" field="field"></carnival-listing-field>\n      </td>\n      <td>\n        <carnival-listing-extra-action ng-repeat="extraAction in extraActions" item="data" extra-action=\'extraAction\'></carnival-listing-extra-action>\n        <carnival-button label="{{ \'Show\' | translate }}" style="primary" size="xs" ng-click="actions.show(data[identifier])"></carnival-button>\n        <carnival-button label="{{ \'Edit\' | translate }}" style="warning" size="xs" ng-click="actions.edit(data[identifier])"></carnival-button>\n        <carnival-delete-button item-id="data[identifier]" action="actions.delete"></carnival-button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("components/navbar/navbar.html",[]).run(["$templateCache",function(a){a.put("components/navbar/navbar.html",'<div class="navbar navbar-default">\n  <div class="container">\n  <a class="navbar-brand">{{ appName }}</a>\n  <ul class="nav navbar-nav">\n    <li ng-class="{ active: checkSelEntity($index) }" ng-repeat="item in menuItems">\n    <a href="{{ buildUrl(item.link) }}" ng-click="resetPage()">{{ item.label }}</a>\n    </li>\n  </ul>\n  </div>\n</div>\n')}]),angular.module("components/nested-form/nested-form-area.html",[]).run(["$templateCache",function(a){a.put("components/nested-form/nested-form-area.html","<div>\n  <a ng-if='canOpenNestedForm()' class=\"btn btn-default btn-xs\"  ng-click=\"open()\">Create</a>\n\n  <ul ng-if=\"isHasMany()\" class='has-many-field-list'>\n    <li ng-repeat='data in datas[field.name]'>\n      {{data[field.field]}}\n      <a id='removeHasManyOption' ng-click='remove(data.id);' class=\"btn btn-default btn-xs\">Delete</a>\n      <a id='editHasManyOption' ng-click='openWithData(data);' class=\"btn btn-warning btn-xs\">Edit</a>\n      <div id=\"edit_nested_{{field.name}}_{{data[field.identifier]}}\"></div>\n    </li>\n  </ul>\n  <div id=\"create_nested_{{field.entityName}}\">\n  </div>\n</div>\n")}]),angular.module("components/nested-form/nested-form.html",[]).run(["$templateCache",function(a){a.put("components/nested-form/nested-form.html","<div class=\"nested-container\">\n<a class='close-nested btn btn-default btn-xs' ng-click='close()'>Close</a>\n  <h3>{{ 'Create' | translate }} {{ entity.label }}</h3>\n"+'  <carnival-form type=\'nested\' entity=\'entity\' fields="entity.fields" action="entity.action" datas="entity.datas" state="{{state}}" related-resources="entity.relatedResources" editable="true"></carnival-form>\n</div>\n')}]),angular.module("components/notification/notification.html",[]).run(["$templateCache",function(a){a.put("components/notification/notification.html",'<div>\n  <div ng-repeat="notification in notifications" class="alert alert-{{ notification.type }}">{{ notification.message }}</div>\n</div>\n')}]),angular.module("components/order-controller/order-controller.html",[]).run(["$templateCache",function(a){a.put("components/order-controller/order-controller.html",'<a ng-show="checkDirAsc()" style="font-size: 0.75em; cursor: pointer" class="glyphicon glyphicon-chevron-up" ng-click="toggleOrder()"></a>\n<a ng-show="!checkDirAsc()" style="font-size: 0.75em; cursor: pointer" class="glyphicon glyphicon-chevron-down" ng-click="toggleOrder()"></a>\n')}]),angular.module("components/pagination-controller/pagination-controller.html",[]).run(["$templateCache",function(a){a.put("components/pagination-controller/pagination-controller.html",'<nav>\n  <ul class="pagination pagination-sm" style="cursor: pointer;">\n\n    <li ng-class="{ disabled: currentPage === 1 }">\n      <a ng-click="prevPage()">&laquo;</a>\n    </li>\n\n    <li ng-show="currentPage > 2">\n      <a ng-click="jumpTo(currentPage - 2)">{{ currentPage - 2 }}</a>\n    </li>\n\n    <li ng-show="currentPage > 1">\n      <a ng-click="jumpTo(currentPage - 1)">{{ currentPage - 1 }}</a>\n    </li>\n\n    <li class="active">\n      <a>{{ currentPage }}</a>\n    </li>\n\n    <li ng-show="currentPage < totalPages">\n      <a ng-click="jumpTo(currentPage + 1)">{{ currentPage + 1}}</a>\n    </li>\n\n    <li ng-show="currentPage < totalPages - 1">\n      <a ng-click="jumpTo(currentPage + 2)">{{ currentPage + 2}}</a>\n    </li>\n\n    <li ng-class="{ disabled: currentPage === totalPages }">\n      <a ng-click="nextPage()">&raquo;</a>\n    </li>\n\n  </ul>\n</nav>\n')}]),angular.module("components/quickfilter-controller/quickfilter-controller.html",[]).run(["$templateCache",function(a){a.put("components/quickfilter-controller/quickfilter-controller.html",'<span>\n  <carnival-button ng-class="{ disabled: isSelected(filter.field, filter.value()) }" ng-repeat="filter in filters" label="{{ filter.label }}" style="info" size="sm" ng-click="setFilter(filter.field, filter.value())"></carnival-button>\n</span>\n')}]),angular.module("components/search-controller/search-controller.html",[]).run(["$templateCache",function(a){a.put("components/search-controller/search-controller.html",'<div>\n  <h4>{{ \'Search\' | translate }}</h4>\n  <hr/>\n    <p ng-repeat="field in fields" ng-if="field.views.index.searchable" ng-switch="field.type">\n      <label ng-if="field.type !== \'hasMany\'">{{ field.label }}</label>\n      <carnival-text-field ng-switch-when="text" label="field.label" data="searchParams[field.name]" editable="true"></carnival-text-field>\n      <carnival-string-field ng-switch-when="string" label="field.label" data="searchParams[field.name]" editable="true"></carnival-string-field>\n      <carnival-select-field ng-switch-when="belongsTo" editable="true" field="field.field" identifier="field.identifier" items="relatedResources[field.endpoint]" data="searchParams[field.foreignKey]"></carnival-select-field>\n      <carnival-number-field ng-switch-when="number" data="searchParams[field.name]" label="field.label" editable="true"></carnival-number-field>\n    </p>\n  <hr/>\n  <carnival-button label="Submit" size="sm" style="default" ng-click="submit()"></carnival-button>\n</div>\n')}]),angular.module("components/uploader/uploader.html",[]).run(["$templateCache",function(a){a.put("components/uploader/uploader.html",'<div>\n  <input type="file" file-input="files"></input>\n  <carnival-button label="Upload" style="default" size="sm" ng-click="upload()"></carnival-button>\n</div>\n')}]),angular.module("states/main.create/create.html",[]).run(["$templateCache",function(a){a.put("states/main.create/create.html",'<div class="container">\n\n  <h3>{{ \'Create\' | translate }} {{ entity.label }}</h3>\n  <carnival-form entity=\'entity\' fields="entity.fields" action="entity.action" datas="entity.datas" state="create" related-resources="entity.relatedResources" editable="true"></carnival-form>\n\n</div>\n')}]),angular.module("states/main.edit/edit.html",[]).run(["$templateCache",function(a){a.put("states/main.edit/edit.html",'<div class="container">\n\n  <h3>{{ \'Edit\' | translate }} {{ entity.label }}</h3>\n  <carnival-form type=\'normal\' entity="entity" fields="entity.fields" datas="entity.datas" action="entity.action" state="edit" related-resources="entity.relatedResources" editable="true"></carnival-form>\n\n</div>\n')}]),angular.module("states/main.list/list.html",[]).run(["$templateCache",function(a){a.put("states/main.list/list.html",'<div class="container">\n  <div class="col-md-10" style="text-align:left">\n    <h3>{{ \'List of\' | translate }} {{ entity.label }}</h3>\n  </div>\n  <div class="col-md-2" style="text-align:right">\n    <carnival-button label="{{ \'Create\' | translate }}" style="success" size="sm" ng-click="entity.actions.create()"></carnival-button>\n  </div>\n  <div class="col-md-3"></div>\n  <div class="col-md-9">\n    <carnival-quick-filter filters="entity.model.quickFilters"></carnival-quick-filter>\n  </div>\n  <div class="col-md-3">\n    <carnival-search-ctrl fields="entity.fields" related-resources="entity.relatedResources"></carnival-search-ctrl>\n  </div>\n  <div class="col-md-9">\n    <carnival-listing entity="entity" entity-name="entity.name" actions="entity.actions" extra-actions="entity.extraActions" identifier="entity.identifier" datas="entity.datas" fields="entity.fields"></carnival-listing>\n    <carnival-pagination-ctrl current-page="pages.current" total-pages="pages.total"></carnival-pagination-ctrl>\n  </div>\n</div>\n')}]),angular.module("states/main.show/show.html",[]).run(["$templateCache",function(a){a.put("states/main.show/show.html",'<div class="container">\n\n  <h3>{{ \'Show\' | translate }} {{ entity.label }}</h3>\n\n  <div class=\'row\' ng-switch="field.type" ng-repeat="field in entity.fields">\n    <label class="col-sm-2 control-label">{{ field.label }}</label>\n    <div class="col-sm-10" ng-switch-when="belongsTo">\n      {{entity.datas[field.name][field.field]}}\n    </div>\n    <div class="col-sm-10" ng-switch-when="hasMany">\n       <ul>\n          <li ng-repeat="data in entity.datas[field.name]">\n            {{data[field.field]}}\n          </li>\n       </ul>\n    </div>\n    <div class="col-sm-10" ng-switch-when="enum">\n      {{ getValue(entity.datas[field.name], field) }}\n    </div>\n    <carnival-listing-field-file ng-switch-when="file" item="entity.datas" field="field"></carnival-listing-field-file>\n    <carnival-listing-field-currency ng-switch-when="currency" item="entity.datas" field="field"></carnival-listing-field-currency>\n    <div class="col-sm-10" ng-switch-default>\n      {{entity.datas[field.name]}}\n    </div>\n  </div>\n  <label class="col-sm-2 control-label">\n    <carnival-button label="Edit" style="warning" size="sm" ng-click="buttonAction()"></carnival-button>\n  </label>\n</div>\n')}]),angular.module("states/main/main.html",[]).run(["$templateCache",function(a){a.put("states/main/main.html",'<carnival-navbar app-name="app_name" menu-items="menu_items"></carnival-navbar>\n<div class="container">\n  <carnival-notification></carnival-notification>\n</div>\n<div ui-view></div>\n')}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(a,b,c){function d(a,b){return M(new(M(function(){},{prototype:a})),b)}function e(a){return L(arguments,function(b){b!==a&&L(b,function(b,c){a.hasOwnProperty(c)||(a[c]=b)})}),a}function f(a,b){var c=[];for(var d in a.path){if(a.path[d]!==b.path[d])break;c.push(a.path[d])}return c}function g(a){if(Object.keys)return Object.keys(a);var c=[];return b.forEach(a,function(a,b){c.push(b)}),c}function h(a,b){if(Array.prototype.indexOf)return a.indexOf(b,Number(arguments[2])||0);var c=a.length>>>0,d=Number(arguments[2])||0;for(d=0>d?Math.ceil(d):Math.floor(d),0>d&&(d+=c);c>d;d++)if(d in a&&a[d]===b)return d;return-1}function i(a,b,c,d){var e,i=f(c,d),j={},k=[];for(var l in i)if(i[l].params&&(e=g(i[l].params),e.length))for(var m in e)h(k,e[m])>=0||(k.push(e[m]),j[e[m]]=a[e[m]]);return M({},j,b)}function j(a,b,c){if(!c){c=[];for(var d in a)c.push(d)}for(var e=0;e<c.length;e++){var f=c[e];if(a[f]!=b[f])return!1}return!0}function k(a,b){var c={};return L(a,function(a){c[a]=b[a]}),c}function l(a){var b={},c=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var d in a)-1==h(c,d)&&(b[d]=a[d]);return b}function m(a,b){var c=K(a),d=c?[]:{};return L(a,function(a,e){b(a,e)&&(d[c?d.length:e]=a)}),d}function n(a,b){var c=K(a)?[]:{};return L(a,function(a,d){c[d]=b(a,d)}),c}function o(a,b){var d=1,f=2,i={},j=[],k=i,m=M(a.when(i),{$$promises:i,$$values:i});this.study=function(i){function n(a,c){if(s[c]!==f){if(r.push(c),s[c]===d)throw r.splice(0,h(r,c)),new Error("Cyclic dependency: "+r.join(" -> "));if(s[c]=d,I(a))q.push(c,[function(){return b.get(a)}],j);else{var e=b.annotate(a);L(e,function(a){a!==c&&i.hasOwnProperty(a)&&n(i[a],a)}),q.push(c,a,e)}r.pop(),s[c]=f}}function o(a){return J(a)&&a.then&&a.$$promises}if(!J(i))throw new Error("'invocables' must be an object");var p=g(i||{}),q=[],r=[],s={};return L(i,n),i=r=s=null,function(d,f,g){function h(){--u||(v||e(t,f.$$values),r.$$values=t,r.$$promises=r.$$promises||!0,delete r.$$inheritedValues,n.resolve(t))}function i(a){r.$$failure=a,n.reject(a)}function j(c,e,f){function j(a){l.reject(a),i(a)}function k(){if(!G(r.$$failure))try{l.resolve(b.invoke(e,g,t)),l.promise.then(function(a){t[c]=a,h()},j)}catch(a){j(a)}}var l=a.defer(),m=0;L(f,function(a){s.hasOwnProperty(a)&&!d.hasOwnProperty(a)&&(m++,s[a].then(function(b){t[a]=b,--m||k()},j))}),m||k(),s[c]=l.promise}if(o(d)&&g===c&&(g=f,f=d,d=null),d){if(!J(d))throw new Error("'locals' must be an object")}else d=k;if(f){if(!o(f))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else f=m;var n=a.defer(),r=n.promise,s=r.$$promises={},t=M({},d),u=1+q.length/3,v=!1;if(G(f.$$failure))return i(f.$$failure),r;f.$$inheritedValues&&e(t,l(f.$$inheritedValues,p)),M(s,f.$$promises),f.$$values?(v=e(t,l(f.$$values,p)),r.$$inheritedValues=l(f.$$values,p),h()):(f.$$inheritedValues&&(r.$$inheritedValues=l(f.$$inheritedValues,p)),f.then(h,i));for(var w=0,x=q.length;x>w;w+=3)d.hasOwnProperty(q[w])?h():j(q[w],q[w+1],q[w+2]);return r}},this.resolve=function(a,b,c,d){return this.study(a)(b,c,d)}}function p(a,b,c){this.fromConfig=function(a,b,c){return G(a.template)?this.fromString(a.template,b):G(a.templateUrl)?this.fromUrl(a.templateUrl,b):G(a.templateProvider)?this.fromProvider(a.templateProvider,b,c):null},this.fromString=function(a,b){return H(a)?a(b):a},this.fromUrl=function(c,d){return H(c)&&(c=c(d)),null==c?null:a.get(c,{cache:b,headers:{Accept:"text/html"}}).then(function(a){return a.data})},this.fromProvider=function(a,b,d){return c.invoke(a,null,d||{params:b})}}function q(a,b,e){function f(b,c,d,e){if(q.push(b),o[b])return o[b];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(b))throw new Error("Invalid parameter name '"+b+"' in pattern '"+a+"'");if(p[b])throw new Error("Duplicate parameter name '"+b+"' in pattern '"+a+"'");return p[b]=new O.Param(b,c,d,e),p[b]}function g(a,b,c){var d=["",""],e=a.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!b)return e;switch(c){case!1:d=["(",")"];break;case!0:d=["?(",")?"];break;default:d=["("+c+"|",")?"]}return e+d[0]+b+d[1]}function h(c,e){var f,g,h,i,j;return f=c[2]||c[3],j=b.params[f],h=a.substring(m,c.index),g=e?c[4]:c[4]||("*"==c[1]?".*":null),i=O.type(g||"string")||d(O.type("string"),{pattern:new RegExp(g)}),{id:f,regexp:g,segment:h,type:i,cfg:j}}b=M({params:{}},J(b)?b:{});var i,j=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,k=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,l="^",m=0,n=this.segments=[],o=e?e.params:{},p=this.params=e?e.params.$$new():new O.ParamSet,q=[];this.source=a;for(var r,s,t;(i=j.exec(a))&&(r=h(i,!1),!(r.segment.indexOf("?")>=0));)s=f(r.id,r.type,r.cfg,"path"),l+=g(r.segment,s.type.pattern.source,s.squash),n.push(r.segment),m=j.lastIndex;t=a.substring(m);var u=t.indexOf("?");if(u>=0){var v=this.sourceSearch=t.substring(u);if(t=t.substring(0,u),this.sourcePath=a.substring(0,m+u),v.length>0)for(m=0;i=k.exec(v);)r=h(i,!0),s=f(r.id,r.type,r.cfg,"search"),m=j.lastIndex}else this.sourcePath=a,this.sourceSearch="";l+=g(t)+(b.strict===!1?"/?":"")+"$",n.push(t),this.regexp=new RegExp(l,b.caseInsensitive?"i":c),this.prefix=n[0],this.$$paramNames=q}function r(a){M(this,a)}function s(){function a(a){return null!=a?a.toString().replace(/\//g,"%2F"):a}function e(a){return null!=a?a.toString().replace(/%2F/g,"/"):a}function f(a){return this.pattern.test(a)}function i(){return{strict:t,caseInsensitive:p}}function j(a){return H(a)||K(a)&&H(a[a.length-1])}function k(){for(;x.length;){var a=x.shift();if(a.pattern)throw new Error("You cannot override a type's .pattern at runtime.");
b.extend(v[a.name],o.invoke(a.def))}}function l(a){M(this,a||{})}O=this;var o,p=!1,t=!0,u=!1,v={},w=!0,x=[],y={string:{encode:a,decode:e,is:f,pattern:/[^/]*/},"int":{encode:a,decode:function(a){return parseInt(a,10)},is:function(a){return G(a)&&this.decode(a.toString())===a},pattern:/\d+/},bool:{encode:function(a){return a?1:0},decode:function(a){return 0!==parseInt(a,10)},is:function(a){return a===!0||a===!1},pattern:/0|1/},date:{encode:function(a){return this.is(a)?[a.getFullYear(),("0"+(a.getMonth()+1)).slice(-2),("0"+a.getDate()).slice(-2)].join("-"):c},decode:function(a){if(this.is(a))return a;var b=this.capture.exec(a);return b?new Date(b[1],b[2]-1,b[3]):c},is:function(a){return a instanceof Date&&!isNaN(a.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:b.toJson,decode:b.fromJson,is:b.isObject,equals:b.equals,pattern:/[^/]*/},any:{encode:b.identity,decode:b.identity,is:b.identity,equals:b.equals,pattern:/.*/}};s.$$getDefaultValue=function(a){if(!j(a.value))return a.value;if(!o)throw new Error("Injectable functions cannot be called at configuration time");return o.invoke(a.value)},this.caseInsensitive=function(a){return G(a)&&(p=a),p},this.strictMode=function(a){return G(a)&&(t=a),t},this.defaultSquashPolicy=function(a){if(!G(a))return u;if(a!==!0&&a!==!1&&!I(a))throw new Error("Invalid squash policy: "+a+". Valid policies: false, true, arbitrary-string");return u=a,a},this.compile=function(a,b){return new q(a,M(i(),b))},this.isMatcher=function(a){if(!J(a))return!1;var b=!0;return L(q.prototype,function(c,d){H(c)&&(b=b&&G(a[d])&&H(a[d]))}),b},this.type=function(a,b,c){if(!G(b))return v[a];if(v.hasOwnProperty(a))throw new Error("A type named '"+a+"' has already been defined.");return v[a]=new r(M({name:a},b)),c&&(x.push({name:a,def:c}),w||k()),this},L(y,function(a,b){v[b]=new r(M({name:b},a))}),v=d(v,{}),this.$get=["$injector",function(a){return o=a,w=!1,k(),L(y,function(a,b){v[b]||(v[b]=new r(a))}),this}],this.Param=function(a,b,d,e){function f(a){var b=J(a)?g(a):[],c=-1===h(b,"value")&&-1===h(b,"type")&&-1===h(b,"squash")&&-1===h(b,"array");return c&&(a={value:a}),a.$$fn=j(a.value)?a.value:function(){return a.value},a}function i(b,c,d){if(b.type&&c)throw new Error("Param '"+a+"' has two type configurations.");return c?c:b.type?b.type instanceof r?b.type:new r(b.type):"config"===d?v.any:v.string}function k(){var b={array:"search"===e?"auto":!1},c=a.match(/\[\]$/)?{array:!0}:{};return M(b,c,d).array}function l(a,b){var c=a.squash;if(!b||c===!1)return!1;if(!G(c)||null==c)return u;if(c===!0||I(c))return c;throw new Error("Invalid squash policy: '"+c+"'. Valid policies: false, true, or arbitrary string")}function p(a,b,d,e){var f,g,i=[{from:"",to:d||b?c:""},{from:null,to:d||b?c:""}];return f=K(a.replace)?a.replace:[],I(e)&&f.push({from:e,to:c}),g=n(f,function(a){return a.from}),m(i,function(a){return-1===h(g,a.from)}).concat(f)}function q(){if(!o)throw new Error("Injectable functions cannot be called at configuration time");return o.invoke(d.$$fn)}function s(a){function b(a){return function(b){return b.from===a}}function c(a){var c=n(m(w.replace,b(a)),function(a){return a.to});return c.length?c[0]:a}return a=c(a),G(a)?w.type.decode(a):q()}function t(){return"{Param:"+a+" "+b+" squash: '"+z+"' optional: "+y+"}"}var w=this;d=f(d),b=i(d,b,e);var x=k();b=x?b.$asArray(x,"search"===e):b,"string"!==b.name||x||"path"!==e||d.value!==c||(d.value="");var y=d.value!==c,z=l(d,y),A=p(d,x,y,z);M(this,{id:a,type:b,location:e,array:x,squash:z,replace:A,isOptional:y,value:s,dynamic:c,config:d,toString:t})},l.prototype={$$new:function(){return d(this,M(new l,{$$parent:this}))},$$keys:function(){for(var a=[],b=[],c=this,d=g(l.prototype);c;)b.push(c),c=c.$$parent;return b.reverse(),L(b,function(b){L(g(b),function(b){-1===h(a,b)&&-1===h(d,b)&&a.push(b)})}),a},$$values:function(a){var b={},c=this;return L(c.$$keys(),function(d){b[d]=c[d].value(a&&a[d])}),b},$$equals:function(a,b){var c=!0,d=this;return L(d.$$keys(),function(e){var f=a&&a[e],g=b&&b[e];d[e].type.equals(f,g)||(c=!1)}),c},$$validates:function(a){var b,c,d,e=!0,f=this;return L(this.$$keys(),function(g){d=f[g],c=a[g],b=!c&&d.isOptional,e=e&&(b||!!d.type.is(c))}),e},$$parent:c},this.ParamSet=l}function t(a,d){function e(a){var b=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(a.source);return null!=b?b[1].replace(/\\(.)/g,"$1"):""}function f(a,b){return a.replace(/\$(\$|\d{1,2})/,function(a,c){return b["$"===c?0:Number(c)]})}function g(a,b,c){if(!c)return!1;var d=a.invoke(b,b,{$match:c});return G(d)?d:!0}function h(d,e,f,g){function h(a,b,c){return"/"===p?a:b?p.slice(0,-1)+a:c?p.slice(1)+a:a}function m(a){function b(a){var b=a(f,d);return b?(I(b)&&d.replace().url(b),!0):!1}if(!a||!a.defaultPrevented){var e=o&&d.url()===o;if(o=c,e)return!0;var g,h=j.length;for(g=0;h>g;g++)if(b(j[g]))return;k&&b(k)}}function n(){return i=i||e.$on("$locationChangeSuccess",m)}var o,p=g.baseHref(),q=d.url();return l||n(),{sync:function(){m()},listen:function(){return n()},update:function(a){return a?void(q=d.url()):void(d.url()!==q&&(d.url(q),d.replace()))},push:function(a,b,e){d.url(a.format(b||{})),o=e&&e.$$avoidResync?d.url():c,e&&e.replace&&d.replace()},href:function(c,e,f){if(!c.validates(e))return null;var g=a.html5Mode();b.isObject(g)&&(g=g.enabled);var i=c.format(e);if(f=f||{},g||null===i||(i="#"+a.hashPrefix()+i),i=h(i,g,f.absolute),!f.absolute||!i)return i;var j=!g&&i?"/":"",k=d.port();return k=80===k||443===k?"":":"+k,[d.protocol(),"://",d.host(),k,j,i].join("")}}}var i,j=[],k=null,l=!1;this.rule=function(a){if(!H(a))throw new Error("'rule' must be a function");return j.push(a),this},this.otherwise=function(a){if(I(a)){var b=a;a=function(){return b}}else if(!H(a))throw new Error("'rule' must be a function");return k=a,this},this.when=function(a,b){var c,h=I(b);if(I(a)&&(a=d.compile(a)),!h&&!H(b)&&!K(b))throw new Error("invalid 'handler' in when()");var i={matcher:function(a,b){return h&&(c=d.compile(b),b=["$match",function(a){return c.format(a)}]),M(function(c,d){return g(c,b,a.exec(d.path(),d.search()))},{prefix:I(a.prefix)?a.prefix:""})},regex:function(a,b){if(a.global||a.sticky)throw new Error("when() RegExp must not be global or sticky");return h&&(c=b,b=["$match",function(a){return f(c,a)}]),M(function(c,d){return g(c,b,a.exec(d.path()))},{prefix:e(a)})}},j={matcher:d.isMatcher(a),regex:a instanceof RegExp};for(var k in j)if(j[k])return this.rule(i[k](a,b));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(a){a===c&&(a=!0),l=a},this.$get=h,h.$inject=["$location","$rootScope","$injector","$browser"]}function u(a,e){function f(a){return 0===a.indexOf(".")||0===a.indexOf("^")}function l(a,b){if(!a)return c;var d=I(a),e=d?a:a.name,g=f(e);if(g){if(!b)throw new Error("No reference point given for path '"+e+"'");b=l(b);for(var h=e.split("."),i=0,j=h.length,k=b;j>i;i++)if(""!==h[i]||0!==i){if("^"!==h[i])break;if(!k.parent)throw new Error("Path '"+e+"' not valid for state '"+b.name+"'");k=k.parent}else k=b;h=h.slice(i).join("."),e=k.name+(k.name&&h?".":"")+h}var m=y[e];return!m||!d&&(d||m!==a&&m.self!==a)?c:m}function m(a,b){z[a]||(z[a]=[]),z[a].push(b)}function o(a){for(var b=z[a]||[];b.length;)p(b.shift())}function p(b){b=d(b,{self:b,resolve:b.resolve||{},toString:function(){return this.name}});var c=b.name;if(!I(c)||c.indexOf("@")>=0)throw new Error("State must have a valid name");if(y.hasOwnProperty(c))throw new Error("State '"+c+"'' is already defined");var e=-1!==c.indexOf(".")?c.substring(0,c.lastIndexOf(".")):I(b.parent)?b.parent:J(b.parent)&&I(b.parent.name)?b.parent.name:"";if(e&&!y[e])return m(e,b.self);for(var f in B)H(B[f])&&(b[f]=B[f](b,B.$delegates[f]));return y[c]=b,!b[A]&&b.url&&a.when(b.url,["$match","$stateParams",function(a,c){x.$current.navigable==b&&j(a,c)||x.transitionTo(b,a,{inherit:!0,location:!1})}]),o(c),b}function q(a){return a.indexOf("*")>-1}function r(a){var b=a.split("."),c=x.$current.name.split(".");if("**"===b[0]&&(c=c.slice(h(c,b[1])),c.unshift("**")),"**"===b[b.length-1]&&(c.splice(h(c,b[b.length-2])+1,Number.MAX_VALUE),c.push("**")),b.length!=c.length)return!1;for(var d=0,e=b.length;e>d;d++)"*"===b[d]&&(c[d]="*");return c.join("")===b.join("")}function s(a,b){return I(a)&&!G(b)?B[a]:H(b)&&I(a)?(B[a]&&!B.$delegates[a]&&(B.$delegates[a]=B[a]),B[a]=b,this):this}function t(a,b){return J(a)?b=a:b.name=a,p(b),this}function u(a,e,f,h,m,o,p){function s(b,c,d,f){var g=a.$broadcast("$stateNotFound",b,c,d);if(g.defaultPrevented)return p.update(),B;if(!g.retry)return null;if(f.$retry)return p.update(),C;var h=x.transition=e.when(g.retry);return h.then(function(){return h!==x.transition?u:(b.options.$retry=!0,x.transitionTo(b.to,b.toParams,b.options))},function(){return B}),p.update(),h}function t(a,c,d,g,i,j){var l=d?c:k(a.params.$$keys(),c),n={$stateParams:l};i.resolve=m.resolve(a.resolve,n,i.resolve,a);var o=[i.resolve.then(function(a){i.globals=a})];return g&&o.push(g),L(a.views,function(c,d){var e=c.resolve&&c.resolve!==a.resolve?c.resolve:{};e.$template=[function(){return f.load(d,{view:c,locals:n,params:l,notify:j.notify})||""}],o.push(m.resolve(e,n,i.resolve,a).then(function(f){if(H(c.controllerProvider)||K(c.controllerProvider)){var g=b.extend({},e,n);f.$$controller=h.invoke(c.controllerProvider,null,g)}else f.$$controller=c.controller;f.$$state=a,f.$$controllerAs=c.controllerAs,i[d]=f}))}),e.all(o).then(function(){return i})}var u=e.reject(new Error("transition superseded")),z=e.reject(new Error("transition prevented")),B=e.reject(new Error("transition aborted")),C=e.reject(new Error("transition failed"));return w.locals={resolve:null,globals:{$stateParams:{}}},x={params:{},current:w.self,$current:w,transition:null},x.reload=function(){return x.transitionTo(x.current,o,{reload:!0,inherit:!1,notify:!0})},x.go=function(a,b,c){return x.transitionTo(a,b,M({inherit:!0,relative:x.$current},c))},x.transitionTo=function(b,c,f){c=c||{},f=M({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},f||{});var g,j=x.$current,m=x.params,n=j.path,q=l(b,f.relative);if(!G(q)){var r={to:b,toParams:c,options:f},y=s(r,j.self,m,f);if(y)return y;if(b=r.to,c=r.toParams,f=r.options,q=l(b,f.relative),!G(q)){if(!f.relative)throw new Error("No such state '"+b+"'");throw new Error("Could not resolve '"+b+"' from state '"+f.relative+"'")}}if(q[A])throw new Error("Cannot transition to abstract state '"+b+"'");if(f.inherit&&(c=i(o,c||{},x.$current,q)),!q.params.$$validates(c))return C;c=q.params.$$values(c),b=q;var B=b.path,D=0,E=B[D],F=w.locals,H=[];if(!f.reload)for(;E&&E===n[D]&&E.ownParams.$$equals(c,m);)F=H[D]=E.locals,D++,E=B[D];if(v(b,j,F,f))return b.self.reloadOnSearch!==!1&&p.update(),x.transition=null,e.when(x.current);if(c=k(b.params.$$keys(),c||{}),f.notify&&a.$broadcast("$stateChangeStart",b.self,c,j.self,m).defaultPrevented)return p.update(),z;for(var I=e.when(F),J=D;J<B.length;J++,E=B[J])F=H[J]=d(F),I=t(E,c,E===b,I,F,f);var K=x.transition=I.then(function(){var d,e,g;if(x.transition!==K)return u;for(d=n.length-1;d>=D;d--)g=n[d],g.self.onExit&&h.invoke(g.self.onExit,g.self,g.locals.globals),g.locals=null;for(d=D;d<B.length;d++)e=B[d],e.locals=H[d],e.self.onEnter&&h.invoke(e.self.onEnter,e.self,e.locals.globals);return x.transition!==K?u:(x.$current=b,x.current=b.self,x.params=c,N(x.params,o),x.transition=null,f.location&&b.navigable&&p.push(b.navigable.url,b.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===f.location}),f.notify&&a.$broadcast("$stateChangeSuccess",b.self,c,j.self,m),p.update(!0),x.current)},function(d){return x.transition!==K?u:(x.transition=null,g=a.$broadcast("$stateChangeError",b.self,c,j.self,m,d),g.defaultPrevented||p.update(),e.reject(d))});return K},x.is=function(a,b,d){d=M({relative:x.$current},d||{});var e=l(a,d.relative);return G(e)?x.$current!==e?!1:b?j(e.params.$$values(b),o):!0:c},x.includes=function(a,b,d){if(d=M({relative:x.$current},d||{}),I(a)&&q(a)){if(!r(a))return!1;a=x.$current.name}var e=l(a,d.relative);return G(e)?G(x.$current.includes[e.name])?b?j(e.params.$$values(b),o,g(b)):!0:!1:c},x.href=function(a,b,d){d=M({lossy:!0,inherit:!0,absolute:!1,relative:x.$current},d||{});var e=l(a,d.relative);if(!G(e))return null;d.inherit&&(b=i(o,b||{},x.$current,e));var f=e&&d.lossy?e.navigable:e;return f&&f.url!==c&&null!==f.url?p.href(f.url,k(e.params.$$keys(),b||{}),{absolute:d.absolute}):null},x.get=function(a,b){if(0===arguments.length)return n(g(y),function(a){return y[a].self});var c=l(a,b||x.$current);return c&&c.self?c.self:null},x}function v(a,b,c,d){return a!==b||(c!==b.locals||d.reload)&&a.self.reloadOnSearch!==!1?void 0:!0}var w,x,y={},z={},A="abstract",B={parent:function(a){if(G(a.parent)&&a.parent)return l(a.parent);var b=/^(.+)\.[^.]+$/.exec(a.name);return b?l(b[1]):w},data:function(a){return a.parent&&a.parent.data&&(a.data=a.self.data=M({},a.parent.data,a.data)),a.data},url:function(a){var b=a.url,c={params:a.params||{}};if(I(b))return"^"==b.charAt(0)?e.compile(b.substring(1),c):(a.parent.navigable||w).url.concat(b,c);if(!b||e.isMatcher(b))return b;throw new Error("Invalid url '"+b+"' in state '"+a+"'")},navigable:function(a){return a.url?a:a.parent?a.parent.navigable:null},ownParams:function(a){var b=a.url&&a.url.params||new O.ParamSet;return L(a.params||{},function(a,c){b[c]||(b[c]=new O.Param(c,null,a,"config"))}),b},params:function(a){return a.parent&&a.parent.params?M(a.parent.params.$$new(),a.ownParams):new O.ParamSet},views:function(a){var b={};return L(G(a.views)?a.views:{"":a},function(c,d){d.indexOf("@")<0&&(d+="@"+a.parent.name),b[d]=c}),b},path:function(a){return a.parent?a.parent.path.concat(a):[]},includes:function(a){var b=a.parent?M({},a.parent.includes):{};return b[a.name]=!0,b},$delegates:{}};w=p({name:"",url:"^",views:null,"abstract":!0}),w.navigable=null,this.decorator=s,this.state=t,this.$get=u,u.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function v(){function a(a,b){return{load:function(c,d){var e,f={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return d=M(f,d),d.view&&(e=b.fromConfig(d.view,d.params,d.locals)),e&&d.notify&&a.$broadcast("$viewContentLoading",d),e}}}this.$get=a,a.$inject=["$rootScope","$templateFactory"]}function w(){var a=!1;this.useAnchorScroll=function(){a=!0},this.$get=["$anchorScroll","$timeout",function(b,c){return a?b:function(a){c(function(){a[0].scrollIntoView()},0,!1)}}]}function x(a,c,d,e){function f(){return c.has?function(a){return c.has(a)?c.get(a):null}:function(a){try{return c.get(a)}catch(b){return null}}}function g(a,b){var c=function(){return{enter:function(a,b,c){b.after(a),c()},leave:function(a,b){a.remove(),b()}}};if(j)return{enter:function(a,b,c){var d=j.enter(a,null,b,c);d&&d.then&&d.then(c)},leave:function(a,b){var c=j.leave(a,b);c&&c.then&&c.then(b)}};if(i){var d=i&&i(b,a);return{enter:function(a,b,c){d.enter(a,null,b),c()},leave:function(a,b){d.leave(a),b()}}}return c()}var h=f(),i=h("$animator"),j=h("$animate"),k={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(c,f,h){return function(c,f,i){function j(){l&&(l.remove(),l=null),n&&(n.$destroy(),n=null),m&&(r.leave(m,function(){l=null}),l=m,m=null)}function k(g){var k,l=z(c,i,f,e),s=l&&a.$current&&a.$current.locals[l];if(g||s!==o){k=c.$new(),o=a.$current.locals[l];var t=h(k,function(a){r.enter(a,f,function(){n&&n.$emit("$viewContentAnimationEnded"),(b.isDefined(q)&&!q||c.$eval(q))&&d(a)}),j()});m=t,n=k,n.$emit("$viewContentLoaded"),n.$eval(p)}}var l,m,n,o,p=i.onload||"",q=i.autoscroll,r=g(i,c);c.$on("$stateChangeSuccess",function(){k(!1)}),c.$on("$viewContentLoading",function(){k(!1)}),k(!0)}}};return k}function y(a,b,c,d){return{restrict:"ECA",priority:-400,compile:function(e){var f=e.html();return function(e,g,h){var i=c.$current,j=z(e,h,g,d),k=i&&i.locals[j];if(k){g.data("$uiView",{name:j,state:k.$$state}),g.html(k.$template?k.$template:f);var l=a(g.contents());if(k.$$controller){k.$scope=e;var m=b(k.$$controller,k);k.$$controllerAs&&(e[k.$$controllerAs]=m),g.data("$ngControllerController",m),g.children().data("$ngControllerController",m)}l(e)}}}}}function z(a,b,c,d){var e=d(b.uiView||b.name||"")(a),f=c.inheritedData("$uiView");return e.indexOf("@")>=0?e:e+"@"+(f?f.state.name:"")}function A(a,b){var c,d=a.match(/^\s*({[^}]*})\s*$/);if(d&&(a=b+"("+d[1]+")"),c=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!c||4!==c.length)throw new Error("Invalid state ref '"+a+"'");return{state:c[1],paramExpr:c[3]||null}}function B(a){var b=a.parent().inheritedData("$uiView");return b&&b.state&&b.state.name?b.state:void 0}function C(a,c){var d=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(e,f,g,h){var i=A(g.uiSref,a.current.name),j=null,k=B(f)||a.$current,l=null,m="A"===f.prop("tagName"),n="FORM"===f[0].nodeName,o=n?"action":"href",p=!0,q={relative:k,inherit:!0},r=e.$eval(g.uiSrefOpts)||{};b.forEach(d,function(a){a in r&&(q[a]=r[a])});var s=function(c){if(c&&(j=b.copy(c)),p){l=a.href(i.state,j,q);var d=h[1]||h[0];return d&&d.$$setStateInfo(i.state,j),null===l?(p=!1,!1):void g.$set(o,l)}};i.paramExpr&&(e.$watch(i.paramExpr,function(a){a!==j&&s(a)},!0),j=b.copy(e.$eval(i.paramExpr))),s(),n||f.bind("click",function(b){var d=b.which||b.button;if(!(d>1||b.ctrlKey||b.metaKey||b.shiftKey||f.attr("target"))){var e=c(function(){a.go(i.state,j,q)});b.preventDefault();var g=m&&!l?1:0;b.preventDefault=function(){g--<=0&&c.cancel(e)}}})}}}function D(a,b,c){return{restrict:"A",controller:["$scope","$element","$attrs",function(b,d,e){function f(){g()?d.addClass(j):d.removeClass(j)}function g(){return"undefined"!=typeof e.uiSrefActiveEq?h&&a.is(h.name,i):h&&a.includes(h.name,i)}var h,i,j;j=c(e.uiSrefActiveEq||e.uiSrefActive||"",!1)(b),this.$$setStateInfo=function(b,c){h=a.get(b,B(d)),i=c,f()},b.$on("$stateChangeSuccess",f)}]}}function E(a){var b=function(b){return a.is(b)};return b.$stateful=!0,b}function F(a){var b=function(b){return a.includes(b)};return b.$stateful=!0,b}var G=b.isDefined,H=b.isFunction,I=b.isString,J=b.isObject,K=b.isArray,L=b.forEach,M=b.extend,N=b.copy;b.module("ui.router.util",["ng"]),b.module("ui.router.router",["ui.router.util"]),b.module("ui.router.state",["ui.router.router","ui.router.util"]),b.module("ui.router",["ui.router.state"]),b.module("ui.router.compat",["ui.router"]),o.$inject=["$q","$injector"],b.module("ui.router.util").service("$resolve",o),p.$inject=["$http","$templateCache","$injector"],b.module("ui.router.util").service("$templateFactory",p);var O;q.prototype.concat=function(a,b){var c={caseInsensitive:O.caseInsensitive(),strict:O.strictMode(),squash:O.defaultSquashPolicy()};return new q(this.sourcePath+a+this.sourceSearch,M(c,b),this)},q.prototype.toString=function(){return this.source},q.prototype.exec=function(a,b){function c(a){function b(a){return a.split("").reverse().join("")}function c(a){return a.replace(/\\-/,"-")}var d=b(a).split(/-(?!\\)/),e=n(d,b);return n(e,c).reverse()}var d=this.regexp.exec(a);if(!d)return null;b=b||{};var e,f,g,h=this.parameters(),i=h.length,j=this.segments.length-1,k={};if(j!==d.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(e=0;j>e;e++){g=h[e];var l=this.params[g],m=d[e+1];for(f=0;f<l.replace;f++)l.replace[f].from===m&&(m=l.replace[f].to);m&&l.array===!0&&(m=c(m)),k[g]=l.value(m)}for(;i>e;e++)g=h[e],k[g]=this.params[g].value(b[g]);return k},q.prototype.parameters=function(a){return G(a)?this.params[a]||null:this.$$paramNames},q.prototype.validates=function(a){return this.params.$$validates(a)},q.prototype.format=function(a){function b(a){return encodeURIComponent(a).replace(/-/g,function(a){return"%5C%"+a.charCodeAt(0).toString(16).toUpperCase()})}a=a||{};var c=this.segments,d=this.parameters(),e=this.params;if(!this.validates(a))return null;var f,g=!1,h=c.length-1,i=d.length,j=c[0];for(f=0;i>f;f++){var k=h>f,l=d[f],m=e[l],o=m.value(a[l]),p=m.isOptional&&m.type.equals(m.value(),o),q=p?m.squash:!1,r=m.type.encode(o);if(k){var s=c[f+1];if(q===!1)null!=r&&(j+=K(r)?n(r,b).join("-"):encodeURIComponent(r)),j+=s;else if(q===!0){var t=j.match(/\/$/)?/\/?(.*)/:/(.*)/;j+=s.match(t)[1]}else I(q)&&(j+=q+s)}else{if(null==r||p&&q!==!1)continue;K(r)||(r=[r]),r=n(r,encodeURIComponent).join("&"+l+"="),j+=(g?"&":"?")+(l+"="+r),g=!0}}return j},r.prototype.is=function(){return!0},r.prototype.encode=function(a){return a},r.prototype.decode=function(a){return a},r.prototype.equals=function(a,b){return a==b},r.prototype.$subPattern=function(){var a=this.pattern.toString();return a.substr(1,a.length-2)},r.prototype.pattern=/.*/,r.prototype.toString=function(){return"{Type:"+this.name+"}"},r.prototype.$asArray=function(a,b){function d(a,b){function d(a,b){return function(){return a[b].apply(a,arguments)}}function e(a){return K(a)?a:G(a)?[a]:[]}function f(a){switch(a.length){case 0:return c;case 1:return"auto"===b?a[0]:a;default:return a}}function g(a){return!a}function h(a,b){return function(c){c=e(c);var d=n(c,a);return b===!0?0===m(d,g).length:f(d)}}function i(a){return function(b,c){var d=e(b),f=e(c);if(d.length!==f.length)return!1;for(var g=0;g<d.length;g++)if(!a(d[g],f[g]))return!1;return!0}}this.encode=h(d(a,"encode")),this.decode=h(d(a,"decode")),this.is=h(d(a,"is"),!0),this.equals=i(d(a,"equals")),this.pattern=a.pattern,this.$arrayMode=b}if(!a)return this;if("auto"===a&&!b)throw new Error("'auto' array mode is for query parameters only");return new d(this,a)},b.module("ui.router.util").provider("$urlMatcherFactory",s),b.module("ui.router.util").run(["$urlMatcherFactory",function(){}]),t.$inject=["$locationProvider","$urlMatcherFactoryProvider"],b.module("ui.router.router").provider("$urlRouter",t),u.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],b.module("ui.router.state").value("$stateParams",{}).provider("$state",u),v.$inject=[],b.module("ui.router.state").provider("$view",v),b.module("ui.router.state").provider("$uiViewScroll",w),x.$inject=["$state","$injector","$uiViewScroll","$interpolate"],y.$inject=["$compile","$controller","$state","$interpolate"],b.module("ui.router.state").directive("uiView",x),b.module("ui.router.state").directive("uiView",y),C.$inject=["$state","$timeout"],D.$inject=["$state","$stateParams","$interpolate"],b.module("ui.router.state").directive("uiSref",C).directive("uiSrefActive",D).directive("uiSrefActiveEq",D),E.$inject=["$state"],F.$inject=["$state"],b.module("ui.router.state").filter("isState",E).filter("includedByState",F)}(window,window.angular),function(){"Use Strict";function a(a){try{return 0!==angular.element(a).length}catch(b){return!1}}function b(a,c){var d=[],e=a.children();return e.length&&angular.forEach(e,function(a){d=d.concat(b(angular.element(a),c))}),void 0!==a.attr(c)&&d.push(a),d}function c(b,c){if(!b||""===b||n.hasOwnProperty(b))throw"textAngular Error: A unique name is required for a Tool Definition";if(c.display&&(""===c.display||!a(c.display))||!c.display&&!c.buttontext&&!c.iconclass)throw'textAngular Error: Tool Definition for "'+b+'" does not have a valid display/iconclass/buttontext value';n[b]=c}var d=!1;/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent)&&(document.addEventListener("click",function(){var a=window.event.target;if(d&&null!==a){for(var b=!1,c=a;null!==c&&"html"!==c.tagName.toLowerCase()&&!b;)b="true"===c.contentEditable,c=c.parentNode;b||(document.getElementById("textAngular-editableFix-010203040506070809").setSelectionRange(0,0),a.focus())}d=!1},!1),angular.element(document).ready(function(){angular.element(document.body).append(angular.element('<input id="textAngular-editableFix-010203040506070809" style="width:1px;height:1px;border:none;margin:0;padding:0;position:absolute; top: -10000; left: -10000;" unselectable="on" tabIndex="-1">'))}));var e=function(){var a,b=-1,c=window.navigator.userAgent,d=c.indexOf("MSIE "),e=c.indexOf("Trident/");if(d>0)b=parseInt(c.substring(d+5,c.indexOf(".",d)),10);else if(e>0){var f=c.indexOf("rv:");b=parseInt(c.substring(f+3,c.indexOf(".",f)),10)}return b>-1?b:a}();"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")});var f,g,h,i,j;if(e>8||void 0===e){var k=function(){var a=document.createElement("style");return/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent)&&a.appendChild(document.createTextNode("")),document.head.insertBefore(a,document.head.firstChild),a.sheet}();f=function(){var a=document.createElement("style");return/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent)&&a.appendChild(document.createTextNode("")),document.head.appendChild(a),a.sheet}(),g=function(a,b){i(f,a,b)},i=function(a,b,c){var d;return a.rules?d=Math.max(a.rules.length-1,0):a.cssRules&&(d=Math.max(a.cssRules.length-1,0)),a.insertRule?a.insertRule(b+"{"+c+"}",d):a.addRule(b,c,d),d},h=function(a){j(f,a)},j=function(a,b){a.removeRule?a.removeRule(b):a.deleteRule(b)},i(k,".ta-scroll-window.form-control","height: auto; min-height: 300px; overflow: auto; font-family: inherit; font-size: 100%; position: relative; padding: 0;"),i(k,".ta-root.focussed .ta-scroll-window.form-control","border-color: #66afe9; outline: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);"),i(k,".ta-editor.ta-html","min-height: 300px; height: auto; overflow: auto; font-family: inherit; font-size: 100%;"),i(k,".ta-scroll-window > .ta-bind","height: auto; min-height: 300px; padding: 6px 12px;"),i(k,".ta-root .ta-resizer-handle-overlay","z-index: 100; position: absolute; display: none;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-info","position: absolute; bottom: 16px; right: 16px; border: 1px solid black; background-color: #FFF; padding: 0 4px; opacity: 0.7;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-background","position: absolute; bottom: 5px; right: 5px; left: 5px; top: 5px; border: 1px solid black; background-color: rgba(0, 0, 0, 0.2);"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-corner","width: 10px; height: 10px; position: absolute;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-corner-tl","top: 0; left: 0; border-left: 1px solid black; border-top: 1px solid black;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-corner-tr","top: 0; right: 0; border-right: 1px solid black; border-top: 1px solid black;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-corner-bl","bottom: 0; left: 0; border-left: 1px solid black; border-bottom: 1px solid black;"),i(k,".ta-root .ta-resizer-handle-overlay > .ta-resizer-handle-corner-br","bottom: 0; right: 0; border: 1px solid black; cursor: se-resize; background-color: white;")}var l=!1,m=angular.module("textAngular",["ngSanitize","textAngularSetup"]),n={};m.constant("taRegisterTool",c),m.value("taTools",n),m.config([function(){angular.forEach(n,function(a,b){delete n[b]})}]),m.directive("textAngular",["$compile","$timeout","taOptions","taSelection","taExecCommand","textAngularManager","$window","$document","$animate","$log",function(a,b,c,d,e,f,g,h,i,j){return{require:"?ngModel",scope:{},restrict:"EA",link:function(k,l,m,n){var o,p,q,r,s,t,u,v,w,x=m.serial?m.serial:Math.floor(1e16*Math.random()),y=m.name?m.name:"textAngularEditor"+x,z=function(a,c,d){b(function(){var b=function(){a.off(c,b),d()};a.on(c,b)},100)};w=e(m.taDefaultWrap),angular.extend(k,angular.copy(c),{wrapSelection:function(a,b,c){w(a,!1,b),c&&k["reApplyOnSelectorHandlerstaTextElement"+x](),k.displayElements.text[0].focus()},showHtml:!1}),m.taFocussedClass&&(k.classes.focussed=m.taFocussedClass),m.taTextEditorClass&&(k.classes.textEditor=m.taTextEditorClass),m.taHtmlEditorClass&&(k.classes.htmlEditor=m.taHtmlEditorClass),m.taTextEditorSetup&&(k.setup.textEditorSetup=k.$parent.$eval(m.taTextEditorSetup)),m.taHtmlEditorSetup&&(k.setup.htmlEditorSetup=k.$parent.$eval(m.taHtmlEditorSetup)),k.fileDropHandler=m.taFileDrop?k.$parent.$eval(m.taFileDrop):k.defaultFileDropHandler,u=l[0].innerHTML,l[0].innerHTML="",k.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),scrollWindow:angular.element("<div class='ta-scroll-window'></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'),popoverArrow:angular.element('<div class="arrow"></div>'),popoverContainer:angular.element('<div class="popover-content"></div>'),resize:{overlay:angular.element('<div class="ta-resizer-handle-overlay"></div>'),background:angular.element('<div class="ta-resizer-handle-background"></div>'),anchors:[angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')],info:angular.element('<div class="ta-resizer-handle-info"></div>')}},k.displayElements.popover.append(k.displayElements.popoverArrow),k.displayElements.popover.append(k.displayElements.popoverContainer),k.displayElements.scrollWindow.append(k.displayElements.popover),k.displayElements.popover.on("mousedown",function(a,b){return b&&angular.extend(a,b),a.preventDefault(),!1}),k.showPopover=function(a){k.displayElements.popover.css("display","block"),k.reflowPopover(a),i.addClass(k.displayElements.popover,"in"),z(l,"click keyup",function(){k.hidePopover()})},k.reflowPopover=function(a){k.displayElements.text[0].offsetHeight-51>a[0].offsetTop?(k.displayElements.popover.css("top",a[0].offsetTop+a[0].offsetHeight+"px"),k.displayElements.popover.removeClass("top").addClass("bottom")):(k.displayElements.popover.css("top",a[0].offsetTop-54+"px"),k.displayElements.popover.removeClass("bottom").addClass("top"));var b=k.displayElements.text[0].offsetWidth-k.displayElements.popover[0].offsetWidth,c=a[0].offsetLeft+a[0].offsetWidth/2-k.displayElements.popover[0].offsetWidth/2;k.displayElements.popover.css("left",Math.max(0,Math.min(b,c))+"px"),k.displayElements.popoverArrow.css("margin-left",Math.min(c,Math.max(0,c-b))-11+"px")},k.hidePopover=function(){i.removeClass(k.displayElements.popover,"in",function(){k.displayElements.popover.css("display",""),k.displayElements.popoverContainer.attr("style",""),k.displayElements.popoverContainer.attr("class","popover-content")})},k.displayElements.resize.overlay.append(k.displayElements.resize.background),angular.forEach(k.displayElements.resize.anchors,function(a){k.displayElements.resize.overlay.append(a)}),k.displayElements.resize.overlay.append(k.displayElements.resize.info),k.displayElements.scrollWindow.append(k.displayElements.resize.overlay),k.reflowResizeOverlay=function(a){a=angular.element(a)[0],k.displayElements.resize.overlay.css({display:"block",left:a.offsetLeft-5+"px",top:a.offsetTop-5+"px",width:a.offsetWidth+10+"px",height:a.offsetHeight+10+"px"}),k.displayElements.resize.info.text(a.offsetWidth+" x "+a.offsetHeight)},k.showResizeOverlay=function(a){var b=function(b){var c={width:parseInt(a.attr("width")),height:parseInt(a.attr("height")),x:b.clientX,y:b.clientY};void 0===c.width&&(c.width=a[0].offsetWidth),void 0===c.height&&(c.height=a[0].offsetHeight),k.hidePopover();var d=c.height/c.width,e=function(b){var e={x:Math.max(0,c.width+(b.clientX-c.x)),y:Math.max(0,c.height+(b.clientY-c.y))},f=function(a,b){a=angular.element(a),"img"===a[0].tagName.toLowerCase()&&(b.height&&(a.attr("height",b.height),delete b.height),b.width&&(a.attr("width",b.width),delete b.width)),a.css(b)};if(b.shiftKey){var g=e.y/e.x;f(a,{width:d>g?e.x:e.y/d,height:d>g?e.x*d:e.y})
}else f(a,{width:e.x,height:e.y});k.reflowResizeOverlay(a)};h.find("body").on("mousemove",e),z(k.displayElements.resize.overlay,"mouseup",function(){h.find("body").off("mousemove",e),k.showPopover(a)}),b.stopPropagation(),b.preventDefault()};k.displayElements.resize.anchors[3].on("mousedown",b),k.reflowResizeOverlay(a),z(l,"click",function(){k.hideResizeOverlay()})},k.hideResizeOverlay=function(){k.displayElements.resize.overlay.css("display","")},k.setup.htmlEditorSetup(k.displayElements.html),k.setup.textEditorSetup(k.displayElements.text),k.displayElements.html.attr({id:"taHtmlElement"+x,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html"}),k.displayElements.text.attr({id:"taTextElement"+x,contentEditable:"true","ta-bind":"ta-bind","ng-model":"html"}),k.displayElements.scrollWindow.attr({"ng-hide":"showHtml"}),m.taDefaultWrap&&k.displayElements.text.attr("ta-default-wrap",m.taDefaultWrap),m.taUnsafeSanitizer&&(k.displayElements.text.attr("ta-unsafe-sanitizer",m.taUnsafeSanitizer),k.displayElements.html.attr("ta-unsafe-sanitizer",m.taUnsafeSanitizer)),k.displayElements.scrollWindow.append(k.displayElements.text),l.append(k.displayElements.scrollWindow),l.append(k.displayElements.html),k.displayElements.forminput.attr("name",y),l.append(k.displayElements.forminput),m.tabindex&&(l.removeAttr("tabindex"),k.displayElements.text.attr("tabindex",m.tabindex),k.displayElements.html.attr("tabindex",m.tabindex)),m.placeholder&&(k.displayElements.text.attr("placeholder",m.placeholder),k.displayElements.html.attr("placeholder",m.placeholder)),m.taDisabled&&(k.displayElements.text.attr("ta-readonly","disabled"),k.displayElements.html.attr("ta-readonly","disabled"),k.disabled=k.$parent.$eval(m.taDisabled),k.$parent.$watch(m.taDisabled,function(a){k.disabled=a,k.disabled?l.addClass(k.classes.disabled):l.removeClass(k.classes.disabled)})),a(k.displayElements.scrollWindow)(k),a(k.displayElements.html)(k),k.updateTaBindtaTextElement=k["updateTaBindtaTextElement"+x],k.updateTaBindtaHtmlElement=k["updateTaBindtaHtmlElement"+x],l.addClass("ta-root"),k.displayElements.scrollWindow.addClass("ta-text ta-editor "+k.classes.textEditor),k.displayElements.html.addClass("ta-html ta-editor "+k.classes.htmlEditor),k._actionRunning=!1;var A=!1;if(k.startAction=function(){return k._actionRunning=!0,g.rangy&&g.rangy.saveSelection?(A=g.rangy.saveSelection(),function(){A&&g.rangy.restoreSelection(A)}):void 0},k.endAction=function(){k._actionRunning=!1,A&&g.rangy.removeMarkers(A),A=!1,k.updateSelectedStyles(),k.showHtml||k["updateTaBindtaTextElement"+x]()},s=function(){l.addClass(k.classes.focussed),v.focus()},k.displayElements.html.on("focus",s),k.displayElements.text.on("focus",s),t=function(a){return k._actionRunning||h[0].activeElement===k.displayElements.html[0]||h[0].activeElement===k.displayElements.text[0]||(l.removeClass(k.classes.focussed),v.unfocus(),b(function(){l.triggerHandler("blur")},0)),a.preventDefault(),!1},k.displayElements.html.on("blur",t),k.displayElements.text.on("blur",t),k.queryFormatBlockState=function(a){return!k.showHtml&&a.toLowerCase()===h[0].queryCommandValue("formatBlock").toLowerCase()},k.queryCommandState=function(a){return k.showHtml?"":h[0].queryCommandState(a)},k.switchView=function(){k.showHtml=!k.showHtml,k.showHtml?b(function(){return k.displayElements.html[0].focus()},100):b(function(){return k.displayElements.text[0].focus()},100)},m.ngModel){var B=!0;n.$render=function(){if(B){B=!1;var a=k.$parent.$eval(m.ngModel);void 0!==a&&null!==a||!u||""===u||n.$setViewValue(u)}k.displayElements.forminput.val(n.$viewValue),k._elementSelectTriggered||h[0].activeElement===k.displayElements.html[0]||h[0].activeElement===k.displayElements.text[0]||(k.html=n.$viewValue||"")};var C=function(a){return m.required&&n.$setValidity("required",!(!a||""===a.trim())),a};n.$parsers.push(C),n.$formatters.push(C)}else k.displayElements.forminput.val(u),k.html=u;if(k.$watch("html",function(a,b){a!==b&&(m.ngModel&&n.$viewValue!==a&&n.$setViewValue(a),k.displayElements.forminput.val(a))}),m.taTargetToolbars)v=f.registerEditor(y,k,m.taTargetToolbars.split(","));else{var D=angular.element('<div text-angular-toolbar name="textAngularToolbar'+x+'">');m.taToolbar&&D.attr("ta-toolbar",m.taToolbar),m.taToolbarClass&&D.attr("ta-toolbar-class",m.taToolbarClass),m.taToolbarGroupClass&&D.attr("ta-toolbar-group-class",m.taToolbarGroupClass),m.taToolbarButtonClass&&D.attr("ta-toolbar-button-class",m.taToolbarButtonClass),m.taToolbarActiveButtonClass&&D.attr("ta-toolbar-active-button-class",m.taToolbarActiveButtonClass),m.taFocussedClass&&D.attr("ta-focussed-class",m.taFocussedClass),l.prepend(D),a(D)(k.$parent),v=f.registerEditor(y,k,["textAngularToolbar"+x])}k.$on("$destroy",function(){f.unregisterEditor(y)}),k.$on("ta-element-select",function(a,b){v.triggerElementSelect(a,b)}),k.$on("ta-drop-event",function(a,b,c,d){k.displayElements.text[0].focus(),d&&d.files&&d.files.length>0&&(angular.forEach(d.files,function(a){try{return k.fileDropHandler(a,k.wrapSelection)||k.fileDropHandler!==k.defaultFileDropHandler&&k.defaultFileDropHandler(a,k.wrapSelection)}catch(b){j.error(b)}}),c.preventDefault(),c.stopPropagation())}),k._bUpdateSelectedStyles=!1,k.updateSelectedStyles=function(){var a;void 0!==(a=d.getSelectionElement())&&a.parentNode!==k.displayElements.text[0]?v.updateSelectedStyles(angular.element(a)):v.updateSelectedStyles(),k._bUpdateSelectedStyles&&b(k.updateSelectedStyles,200)},o=function(){k._bUpdateSelectedStyles||(k._bUpdateSelectedStyles=!0,k.$apply(function(){k.updateSelectedStyles()}))},k.displayElements.html.on("keydown",o),k.displayElements.text.on("keydown",o),p=function(){k._bUpdateSelectedStyles=!1},k.displayElements.html.on("keyup",p),k.displayElements.text.on("keyup",p),q=function(a,b){b&&angular.extend(a,b),k.$apply(function(){return v.sendKeyCommand(a)?(k._bUpdateSelectedStyles||k.updateSelectedStyles(),a.preventDefault(),!1):void 0})},k.displayElements.html.on("keypress",q),k.displayElements.text.on("keypress",q),r=function(){k._bUpdateSelectedStyles=!1,k.$apply(function(){k.updateSelectedStyles()})},k.displayElements.html.on("mouseup",r),k.displayElements.text.on("mouseup",r)}}}]).factory("taBrowserTag",[function(){return function(a){return a?""===a?void 0===e?"div":8>=e?"P":"p":8>=e?a.toUpperCase():a:8>=e?"P":"p"}}]).factory("taExecCommand",["taSelection","taBrowserTag","$document",function(a,b,c){var d=/^(address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/gi,e=/^(ul|li|ol)$/gi,f=function(b,c){var d,e,f=b.find("li");for(e=f.length-1;e>=0;e--)d=angular.element("<"+c+">"+f[e].innerHTML+"</"+c+">"),b.after(d);b.remove(),a.setSelectionToElementEnd(d[0])},g=function(b,c){var d=angular.element("<"+c+">"+b[0].innerHTML+"</"+c+">");b.after(d),b.remove(),a.setSelectionToElementEnd(d.find("li")[0])},h=function(c,d,e){for(var f="",g=0;g<c.length;g++)f+="<"+b("li")+">"+c[g].innerHTML+"</"+b("li")+">";var h=angular.element("<"+e+">"+f+"</"+e+">");d.after(h),d.remove(),a.setSelectionToElementEnd(h.find("li")[0])};return function(i){return i=b(i),function(j,k,l){var m,n,o,p,q,r=angular.element("<"+i+">"),s=a.getSelectionElement(),t=angular.element(s);if(void 0!==s){var u=s.tagName.toLowerCase();if("insertorderedlist"===j.toLowerCase()||"insertunorderedlist"===j.toLowerCase()){var v=b("insertorderedlist"===j.toLowerCase()?"ol":"ul");if(u===v)return f(t,i);if("li"===u&&t.parent()[0].tagName.toLowerCase()===v&&1===t.parent().children().length)return f(t.parent(),i);if("li"===u&&t.parent()[0].tagName.toLowerCase()!==v&&1===t.parent().children().length)return g(t.parent(),v);if(u.match(d)&&!t.hasClass("ta-bind")){if("ol"===u||"ul"===u)return g(t,v);var w=!1;return angular.forEach(t.children(),function(a){a.tagName.match(d)&&(w=!0)}),w?h(t.children(),t,v):h([angular.element("<div>"+s.innerHTML+"</div>")[0]],t,v)}if(u.match(d)){if(p=a.getOnlySelectedElements(),1===p.length&&("ol"===p[0].tagName.toLowerCase()||"ul"===p[0].tagName.toLowerCase()))return p[0].tagName.toLowerCase()===v?f(angular.element(p[0]),i):g(angular.element(p[0]),v);o="";var x=[];for(m=0;m<p.length;m++)if(3!==p[m].nodeType){var y=angular.element(p[m]);o+="<"+b("li")+">"+y[0].innerHTML+"</"+b("li")+">",x.unshift(y)}return n=angular.element("<"+v+">"+o+"</"+v+">"),x.pop().replaceWith(n),angular.forEach(x,function(a){a.remove()}),void a.setSelectionToElementEnd(n[0])}}else if("formatblock"===j.toLowerCase()){var z=l.toLowerCase().replace(/[<>]/gi,"");for(n="li"===u?t.parent():t;!n[0].tagName.match(d);)n=n.parent(),u=n[0].tagName.toLowerCase();if(u===z){p=n.children();var A=!1;for(m=0;m<p.length;m++)A=A||p[m].tagName.match(d);A?(n.after(p),q=n.next(),n.remove(),n=q):(r.append(n[0].childNodes),n.after(r),n.remove(),n=r)}else if(n.parent()[0].tagName.toLowerCase()!==z||n.parent().hasClass("ta-bind"))if(u.match(e))n.wrap(l);else{p=a.getOnlySelectedElements(),0===p.length&&(p=[n[0]]);var B=!1;if(angular.forEach(p,function(a){3!==a.nodeType&&a.tagName.match(d)||(B=!0)}),B)for(;3===p[0].nodeType||!p[0].tagName.match(d);)p=[p[0].parentNode];if(angular.element(p[0]).hasClass("ta-bind"))n=angular.element(l),n[0].innerHTML=p[0].innerHTML,p[0].innerHTML=n[0].outerHTML;else if("blockquote"===z){for(o="",m=0;m<p.length;m++)o+=p[m].outerHTML;n=angular.element(l),n[0].innerHTML=o,p[0].parentNode.insertBefore(n[0],p[0]),angular.forEach(p,function(a){a.parentNode.removeChild(a)})}else for(m=0;m<p.length;m++)n=angular.element(l),n[0].innerHTML=p[m].innerHTML,p[m].parentNode.insertBefore(n[0],p[m]),p[m].parentNode.removeChild(p[m])}else{var C=n.parent(),D=C.contents();for(m=0;m<D.length;m++)C.parent().hasClass("ta-bind")&&3===D[m].nodeType&&(r=angular.element("<"+i+">"),r[0].innerHTML=D[m].outerHTML,D[m]=r[0]),C.parent()[0].insertBefore(D[m],C[0]);C.remove()}return void a.setSelectionToElementEnd(n[0])}}try{c[0].execCommand(j,k,l)}catch(E){}}}}]).directive("taBind",["taSanitize","$timeout","$window","$document","taFixChrome","taBrowserTag","taSelection","taSelectableElements","taApplyCustomRenderers","taOptions",function(a,b,c,f,i,j,k,m,n,o){return{require:"ngModel",scope:{},link:function(j,p,q,r){var s,t,u=void 0!==p.attr("contenteditable")&&p.attr("contenteditable"),v=u||"textarea"===p[0].tagName.toLowerCase()||"input"===p[0].tagName.toLowerCase(),w=!1,x=!1,y=q.taUnsafeSanitizer||o.disableSanitizer;void 0===q.taDefaultWrap&&(q.taDefaultWrap="p"),""===q.taDefaultWrap?(s="",t=void 0===e?"<div><br></div>":e>=11?"<p><br></p>":8>=e?"<P>&nbsp;</P>":"<p>&nbsp;</p>"):(s=void 0===e||e>=11?"<"+q.taDefaultWrap+"><br></"+q.taDefaultWrap+">":8>=e?"<"+q.taDefaultWrap.toUpperCase()+"></"+q.taDefaultWrap.toUpperCase()+">":"<"+q.taDefaultWrap+"></"+q.taDefaultWrap+">",t=void 0===e||e>=11?"<"+q.taDefaultWrap+"><br></"+q.taDefaultWrap+">":8>=e?"<"+q.taDefaultWrap.toUpperCase()+">&nbsp;</"+q.taDefaultWrap.toUpperCase()+">":"<"+q.taDefaultWrap+">&nbsp;</"+q.taDefaultWrap+">"),p.addClass("ta-bind");var z=function(){if(u)return p[0].innerHTML;if(v)return p.val();throw"textAngular Error: attempting to update non-editable taBind"},A=function(a){a||(a=z()),a===t?""!==r.$viewValue&&r.$setViewValue(""):r.$viewValue!==a&&r.$setViewValue(a)};if(j.$parent["updateTaBind"+(q.id||"")]=function(){w||A()},v)if(u){if(p.on("cut",function(a){w?a.preventDefault():b(function(){A()},0)}),p.on("paste",function(a,b){b&&angular.extend(a,b);var d;if(a.clipboardData||a.originalEvent&&a.originalEvent.clipboardData?d=(a.originalEvent||a).clipboardData.getData("text/plain"):c.clipboardData&&(d=c.clipboardData.getData("Text")),!d&&!w)return!0;if(a.preventDefault(),!w){var e=angular.element("<div></div>");if(e[0].innerHTML=d,d=e.text(),f[0].selection){var g=f[0].selection.createRange();g.pasteHTML(d)}else f[0].execCommand("insertText",!1,d);A()}}),p.on("keyup",function(a,b){if(b&&angular.extend(a,b),!w){if(""!==s&&13===a.keyCode&&!a.shiftKey){var c=k.getSelectionElement();if(c.tagName.toLowerCase()!==q.taDefaultWrap&&"li"!==c.tagName.toLowerCase()&&(""===c.innerHTML.trim()||"<br>"===c.innerHTML.trim())){var d=angular.element(s);angular.element(c).replaceWith(d),k.setSelectionToElementStart(d[0])}}var e=z();""!==s&&""===e.trim()&&(p[0].innerHTML=s,k.setSelectionToElementStart(p.children()[0])),A(e)}}),p.on("blur",function(){x=!1,w||A(),r.$render()}),q.placeholder&&(e>8||void 0===e)){var B;if(!q.id)throw"textAngular Error: An unique ID is required for placeholders to work";B=g("#"+q.id+".placeholder-text:before",'content: "'+q.placeholder+'"'),j.$on("$destroy",function(){h(B)})}p.on("focus",function(){x=!0,r.$render()}),p.on("mousedown",function(a,b){b&&angular.extend(a,b),a.stopPropagation()})}else p.on("paste cut",function(){w||b(function(){r.$setViewValue(z())},0)}),p.on("change blur",function(){w||r.$setViewValue(z())});var C=function(b){return r.$oldViewValue=a(i(b),r.$oldViewValue,y)},D=function(a){return q.required&&r.$setValidity("required",!(!a||a.trim()===t||""===a.trim())),a};r.$parsers.push(C),r.$parsers.push(D),r.$formatters.push(C),r.$formatters.push(D);var E=function(a){return j.$emit("ta-element-select",this),a.preventDefault(),!1},F=function(a,c){if(c&&angular.extend(a,c),!l&&!w){l=!0;var d;d=a.originalEvent?a.originalEvent.dataTransfer:a.dataTransfer,j.$emit("ta-drop-event",this,a,d),b(function(){l=!1},100)}};j.$parent["reApplyOnSelectorHandlers"+(q.id||"")]=function(){w||angular.forEach(m,function(a){p.find(a).off("click",E).on("click",E)})};var G=function(a){p[0].innerHTML=a};r.$render=function(){var a=r.$viewValue||"";f[0].activeElement!==p[0]?u?(q.placeholder?""===a?(x?p.removeClass("placeholder-text"):p.addClass("placeholder-text"),G(s)):(p.removeClass("placeholder-text"),G(a)):G(""===a?s:a),w?p.off("drop",F):(angular.forEach(m,function(a){p.find(a).on("click",E)}),p.on("drop",F))):"textarea"!==p[0].tagName.toLowerCase()&&"input"!==p[0].tagName.toLowerCase()?G(n(a)):p.val(a):u&&p.removeClass("placeholder-text")},q.taReadonly&&(w=j.$parent.$eval(q.taReadonly),w?(p.addClass("ta-readonly"),("textarea"===p[0].tagName.toLowerCase()||"input"===p[0].tagName.toLowerCase())&&p.attr("disabled","disabled"),void 0!==p.attr("contenteditable")&&p.attr("contenteditable")&&p.removeAttr("contenteditable")):(p.removeClass("ta-readonly"),"textarea"===p[0].tagName.toLowerCase()||"input"===p[0].tagName.toLowerCase()?p.removeAttr("disabled"):u&&p.attr("contenteditable","true")),j.$parent.$watch(q.taReadonly,function(a,b){b!==a&&(a?(p.addClass("ta-readonly"),("textarea"===p[0].tagName.toLowerCase()||"input"===p[0].tagName.toLowerCase())&&p.attr("disabled","disabled"),void 0!==p.attr("contenteditable")&&p.attr("contenteditable")&&p.removeAttr("contenteditable"),angular.forEach(m,function(a){p.find(a).on("click",E)}),p.off("drop",F)):(p.removeClass("ta-readonly"),"textarea"===p[0].tagName.toLowerCase()||"input"===p[0].tagName.toLowerCase()?p.removeAttr("disabled"):u&&p.attr("contenteditable","true"),angular.forEach(m,function(a){p.find(a).off("click",E)}),p.on("drop",F)),w=a)})),u&&!w&&(angular.forEach(m,function(a){p.find(a).on("click",E)}),p.on("drop",F),p.on("blur",function(){/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent)&&(d=!0)}))}}}]).factory("taApplyCustomRenderers",["taCustomRenderers",function(a){return function(c){var d=angular.element("<div></div>");return d[0].innerHTML=c,angular.forEach(a,function(a){var c=[];a.selector&&""!==a.selector?c=d.find(a.selector):a.customAttribute&&""!==a.customAttribute&&(c=b(d,a.customAttribute)),angular.forEach(c,function(b){b=angular.element(b),a.selector&&""!==a.selector&&a.customAttribute&&""!==a.customAttribute?void 0!==b.attr(a.customAttribute)&&a.renderLogic(b):a.renderLogic(b)})}),d[0].innerHTML}}]).directive("taMaxText",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(a){var b=angular.element("<div/>");b.html(a);var c=b.text().length;return f>=c?(d.$setValidity("taMaxText",!0),a):void d.$setValidity("taMaxText",!1)}var f=parseInt(a.$eval(c.taMaxText));if(isNaN(f))throw"Max text must be an integer";c.$observe("taMaxText",function(a){if(f=parseInt(a),isNaN(f))throw"Max text must be an integer";d.$dirty&&d.$setViewValue(d.$viewValue)}),d.$parsers.unshift(e)}}}).directive("taMinText",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(a){var b=angular.element("<div/>");b.html(a);var c=b.text().length;return!c||c>=f?(d.$setValidity("taMinText",!0),a):void d.$setValidity("taMinText",!1)}var f=parseInt(a.$eval(c.taMinText));if(isNaN(f))throw"Min text must be an integer";c.$observe("taMinText",function(a){if(f=parseInt(a),isNaN(f))throw"Min text must be an integer";d.$dirty&&d.$setViewValue(d.$viewValue)}),d.$parsers.unshift(e)}}}).factory("taFixChrome",function(){var a=function(a){for(var b=angular.element("<div>"+a+"</div>"),c=angular.element(b).find("span"),d=0;d<c.length;d++){var e=angular.element(c[d]);e.attr("style")&&e.attr("style").match(/line-height: 1.428571429;|color: inherit; line-height: 1.1;/i)&&(e.attr("style",e.attr("style").replace(/( |)font-family: inherit;|( |)line-height: 1.428571429;|( |)line-height:1.1;|( |)color: inherit;/gi,"")),e.attr("style")&&""!==e.attr("style")||(e.next().length>0&&"BR"===e.next()[0].tagName&&e.next().remove(),e.replaceWith(e[0].innerHTML)))}var f=b[0].innerHTML.replace(/style="[^"]*?(line-height: 1.428571429;|color: inherit; line-height: 1.1;)[^"]*"/gi,"");return f!==b[0].innerHTML&&(b[0].innerHTML=f),b[0].innerHTML};return a}).factory("taSanitize",["$sanitize",function(a){return function(c,d,e){var f=angular.element("<div>"+c+"</div>");angular.forEach(b(f,"align"),function(a){a.css("text-align",a.attr("align")),a.removeAttr("align")});var g;c=f[0].innerHTML;try{g=a(c),e&&(g=c)}catch(h){g=d||""}return g}}]).directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(a,b,c,d,e,f){return{scope:{name:"@"},restrict:"EA",link:function(g,h,i){if(!g.name||""===g.name)throw"textAngular Error: A toolbar requires a name";angular.extend(g,angular.copy(c)),i.taToolbar&&(g.toolbar=g.$parent.$eval(i.taToolbar)),i.taToolbarClass&&(g.classes.toolbar=i.taToolbarClass),i.taToolbarGroupClass&&(g.classes.toolbarGroup=i.taToolbarGroupClass),i.taToolbarButtonClass&&(g.classes.toolbarButton=i.taToolbarButtonClass),i.taToolbarActiveButtonClass&&(g.classes.toolbarButtonActive=i.taToolbarActiveButtonClass),i.taFocussedClass&&(g.classes.focussed=i.taFocussedClass),g.disabled=!0,g.focussed=!1,g._$element=h,h[0].innerHTML="",h.addClass("ta-toolbar "+g.classes.toolbar),g.$watch("focussed",function(){g.focussed?h.addClass(g.classes.focussed):h.removeClass(g.classes.focussed)});var j=function(b,c){var d;if(d=angular.element(b&&b.display?b.display:"<button type='button'>"),d.addClass(g.classes.toolbarButton),d.attr("name",c.name),d.attr("unselectable","on"),d.attr("ng-disabled","isDisabled()"),d.attr("tabindex","-1"),d.attr("ng-click","executeAction()"),d.attr("ng-class","displayActiveToolClass(active)"),b&&b.tooltiptext&&d.attr("title",b.tooltiptext),d.on("mousedown",function(a,b){return b&&angular.extend(a,b),a.preventDefault(),!1}),b&&!b.display&&!c._display&&(d[0].innerHTML="",b.buttontext&&(d[0].innerHTML=b.buttontext),b.iconclass)){var e=angular.element("<i>"),f=d[0].innerHTML;e.addClass(b.iconclass),d[0].innerHTML="",d.append(e),f&&""!==f&&d.append("&nbsp;"+f)}return c._lastToolDefinition=angular.copy(b),a(d)(c)};g.tools={},g._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1},queryCommandState:function(){return!1}};var k={$window:f,$editor:function(){return g._parent},isDisabled:function(){return this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled},displayActiveToolClass:function(a){return a?g.classes.toolbarButtonActive:""},executeAction:e};angular.forEach(g.toolbar,function(a){var b=angular.element("<div>");b.addClass(g.classes.toolbarGroup),angular.forEach(a,function(a){g.tools[a]=angular.extend(g.$new(!0),d[a],k,{name:a}),g.tools[a].$element=j(d[a],g.tools[a]),b.append(g.tools[a].$element)}),h.append(b)}),g.updateToolDisplay=function(a,b,c){var d=g.tools[a];if(d){if(d._lastToolDefinition&&!c&&(b=angular.extend({},d._lastToolDefinition,b)),null===b.buttontext&&null===b.iconclass&&null===b.display)throw'textAngular Error: Tool Definition for updating "'+a+'" does not have a valid display/iconclass/buttontext value';null===b.buttontext&&delete b.buttontext,null===b.iconclass&&delete b.iconclass,null===b.display&&delete b.display;var e=j(b,d);d.$element.replaceWith(e),d.$element=e}},g.addTool=function(a,b,c,e){g.tools[a]=angular.extend(g.$new(!0),d[a],k,{name:a}),g.tools[a].$element=j(d[a],g.tools[a]);var f;void 0===c&&(c=g.toolbar.length-1),f=angular.element(h.children()[c]),void 0===e?(f.append(g.tools[a].$element),g.toolbar[c][g.toolbar[c].length-1]=a):(f.children().eq(e).after(g.tools[a].$element),g.toolbar[c][e]=a)},b.registerToolbar(g),g.$on("$destroy",function(){b.unregisterToolbar(g.name)})}}}]).service("taToolExecuteAction",["$q",function(a){return function(b){void 0!==b&&(this.$editor=function(){return b});var c=a.defer(),d=c.promise,e=this.$editor();d["finally"](function(){e.endAction.call(e)});var f;try{f=this.action(c,e.startAction())}catch(g){}(f||void 0===f)&&c.resolve()}}]).service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool",function(a,b,c){var d={},e={};return{registerEditor:function(c,f,g){if(!c||""===c)throw"textAngular Error: An editor requires a name";if(!f)throw"textAngular Error: An editor requires a scope";if(e[c])throw'textAngular Error: An Editor with name "'+c+'" already exists';var h=[];return angular.forEach(g,function(a){d[a]&&h.push(d[a])}),e[c]={scope:f,toolbars:g,_registerToolbar:function(a){this.toolbars.indexOf(a.name)>=0&&h.push(a)},editorFunctions:{disable:function(){angular.forEach(h,function(a){a.disabled=!0})},enable:function(){angular.forEach(h,function(a){a.disabled=!1})},focus:function(){angular.forEach(h,function(a){a._parent=f,a.disabled=!1,a.focussed=!0})},unfocus:function(){angular.forEach(h,function(a){a.disabled=!0,a.focussed=!1})},updateSelectedStyles:function(a){angular.forEach(h,function(b){angular.forEach(b.tools,function(b){b.activeState&&(b.active=b.activeState(a))})})},sendKeyCommand:function(c){var d=!1;return(c.ctrlKey||c.metaKey)&&angular.forEach(b,function(b,e){if(b.commandKeyCode&&b.commandKeyCode===c.which)for(var g=0;g<h.length;g++)if(void 0!==h[g].tools[e]){a.call(h[g].tools[e],f),d=!0;break}}),d},triggerElementSelect:function(a,c){var d=function(a,b){for(var c=!0,d=0;d<b.length;d++)c=c&&a.attr(b[d]);return c},e=[],g={},i=!1;c=angular.element(c);var j=!1;if(angular.forEach(b,function(a,b){a.onElementSelect&&a.onElementSelect.element&&a.onElementSelect.element.toLowerCase()===c[0].tagName.toLowerCase()&&(!a.onElementSelect.filter||a.onElementSelect.filter(c))&&(j=j||angular.isArray(a.onElementSelect.onlyWithAttrs)&&d(c,a.onElementSelect.onlyWithAttrs),(!a.onElementSelect.onlyWithAttrs||d(c,a.onElementSelect.onlyWithAttrs))&&(g[b]=a))}),j?(angular.forEach(g,function(a,b){a.onElementSelect.onlyWithAttrs&&d(c,a.onElementSelect.onlyWithAttrs)&&e.push({name:b,tool:a})}),e.sort(function(a,b){return b.tool.onElementSelect.onlyWithAttrs.length-a.tool.onElementSelect.onlyWithAttrs.length})):angular.forEach(g,function(a,b){e.push({name:b,tool:a})}),e.length>0)for(var k=0;k<e.length;k++){for(var l=e[k].tool,m=e[k].name,n=0;n<h.length;n++)if(void 0!==h[n].tools[m]){l.onElementSelect.action.call(h[n].tools[m],a,c,f),i=!0;break}if(i)break}return i}}},e[c].editorFunctions},retrieveEditor:function(a){return e[a]},unregisterEditor:function(a){delete e[a]},registerToolbar:function(a){if(!a)throw"textAngular Error: A toolbar requires a scope";if(!a.name||""===a.name)throw"textAngular Error: A toolbar requires a name";if(d[a.name])throw'textAngular Error: A toolbar with name "'+a.name+'" already exists';d[a.name]=a,angular.forEach(e,function(b){b._registerToolbar(a)})},retrieveToolbar:function(a){return d[a]},retrieveToolbarsViaEditor:function(a){var b=[],c=this;return angular.forEach(this.retrieveEditor(a).toolbars,function(a){b.push(c.retrieveToolbar(a))}),b},unregisterToolbar:function(a){delete d[a]},updateToolsDisplay:function(a){var b=this;angular.forEach(a,function(a,c){b.updateToolDisplay(c,a)})},resetToolsDisplay:function(){var a=this;angular.forEach(b,function(b,c){a.resetToolDisplay(c)})},updateToolDisplay:function(a,b){var c=this;angular.forEach(d,function(d,e){c.updateToolbarToolDisplay(e,a,b)})},resetToolDisplay:function(a){var b=this;angular.forEach(d,function(c,d){b.resetToolbarToolDisplay(d,a)})},updateToolbarToolDisplay:function(a,b,c){if(!d[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';d[a].updateToolDisplay(b,c)},resetToolbarToolDisplay:function(a,c){if(!d[a])throw'textAngular Error: No Toolbar with name "'+a+'" exists';d[a].updateToolDisplay(c,b[c],!0)},removeTool:function(a){delete b[a],angular.forEach(d,function(b){delete b.tools[a];for(var c=0;c<b.toolbar.length;c++){for(var d,e=0;e<b.toolbar[c].length;e++){if(b.toolbar[c][e]===a){d={group:c,index:e};break}if(void 0!==d)break}void 0!==d&&(b.toolbar[d.group].slice(d.index,1),b._$element.children().eq(d.group).children().eq(d.index).remove())}})},addTool:function(a,b,e,f){c(a,b),angular.forEach(d,function(c){c.addTool(a,b,e,f)})},addToolToToolbar:function(a,b,e,f,g){c(a,b),d[e].addTool(a,b,f,g)},refreshEditor:function(a){if(!e[a])throw'textAngular Error: No Editor with name "'+a+'" exists';e[a].scope.updateTaBindtaTextElement(),e[a].scope.$$phase||e[a].scope.$digest()}}}]).service("taSelection",["$window","$document",function(a,b){var c=b[0],d=function(a){if(a.hasChildNodes())return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null},e=function(a){var b=a.startContainer,c=a.endContainer;if(b===c)return[b];for(var e=[];b&&b!==c;)b=d(b),b.parentNode===a.commonAncestorContainer&&e.push(b);for(b=a.startContainer;b&&b!==a.commonAncestorContainer;)b.parentNode===a.commonAncestorContainer&&e.unshift(b),b=b.parentNode;return e};return{getOnlySelectedElements:function(){if(window.getSelection){var b=a.getSelection();if(!b.isCollapsed)return e(b.getRangeAt(0))}return[]},getSelectionElement:function(){var b,d,e;return c.selection&&c.selection.createRange?(b=c.selection.createRange(),b.parentElement()):a.getSelection&&(d=a.getSelection(),d.getRangeAt?d.rangeCount>0&&(b=d.getRangeAt(0)):(b=c.createRange(),b.setStart(d.anchorNode,d.anchorOffset),b.setEnd(d.focusNode,d.focusOffset),b.collapsed!==d.isCollapsed&&(b.setStart(d.focusNode,d.focusOffset),b.setEnd(d.anchorNode,d.anchorOffset))),b)?(e=b.commonAncestorContainer,3===e.nodeType?e.parentNode:e):void 0},setSelectionToElementStart:function(b){if(c.createRange&&a.getSelection){var d=c.createRange();d.selectNodeContents(b),d.setStart(b,0),d.setEnd(b,0);var e=a.getSelection();e.removeAllRanges(),e.addRange(d)}else if(c.selection&&c.body.createTextRange){var f=c.body.createTextRange();f.moveToElementText(b),f.collapse(!0),f.moveEnd("character",0),f.moveStart("character",0),f.select()}},setSelectionToElementEnd:function(b){if(c.createRange&&a.getSelection){var d=c.createRange();d.selectNodeContents(b),d.collapse(!1);var e=a.getSelection();e.removeAllRanges(),e.addRange(d)}else if(c.selection&&c.body.createTextRange){var f=c.body.createTextRange();f.moveToElementText(b),f.collapse(!1),f.select()}}}}])}(),function(a,b){function c(){this.$get=["$$sanitizeUri",function(a){return function(b){var c=[];return f(b,k(c,function(b,c){return!/^unsafe/.test(a(b,c))})),c.join("")}}]}function d(a){var c=[],d=k(c,b.noop);return d.chars(a),c.join("")}function e(a){var b,c={},d=a.split(",");for(b=0;b<d.length;b++)c[d[b]]=!0;return c}function f(a,c){function d(a,d,f,h){if(d=b.lowercase(d),A[d])for(;j.last()&&B[j.last()];)e("",j.last());z[d]&&j.last()==d&&e("",d),h=w[d]||!!h,h||j.push(d);var i={};f.replace(o,function(a,b,c,d,e){var f=c||d||e||"";i[b]=g(f)}),c.start&&c.start(d,i,h)}function e(a,d){var e,f=0;if(d=b.lowercase(d))for(f=j.length-1;f>=0&&j[f]!=d;f--);if(f>=0){for(e=j.length-1;e>=f;e--)c.end&&c.end(j[e]);j.length=f}}var f,h,i,j=[],k=a;for(j.last=function(){return j[j.length-1]};a;){if(h=!0,j.last()&&C[j.last()])a=a.replace(new RegExp("(.*)<\\s*\\/\\s*"+j.last()+"[^>]*>","i"),function(a,b){return b=b.replace(r,"$1").replace(t,"$1"),c.chars&&c.chars(g(b)),""}),e("",j.last());else if(0===a.indexOf("<!--")?(f=a.indexOf("--",4),f>=0&&a.lastIndexOf("-->",f)===f&&(c.comment&&c.comment(a.substring(4,f)),a=a.substring(f+3),h=!1)):s.test(a)?(i=a.match(s),i&&(a=a.replace(i[0],""),h=!1)):q.test(a)?(i=a.match(n),i&&(a=a.substring(i[0].length),i[0].replace(n,e),h=!1)):p.test(a)&&(i=a.match(m),i&&(a=a.substring(i[0].length),i[0].replace(m,d),h=!1)),h){f=a.indexOf("<");var u=0>f?a:a.substring(0,f);a=0>f?"":a.substring(f),c.chars&&c.chars(g(u))}if(a==k)throw l("badparse","The sanitizer was unable to parse the following block of html: {0}",a);k=a}e()}function g(a){if(!a)return"";var b=H.exec(a),c=b[1],d=b[3],e=b[2];return e&&(G.innerHTML=e.replace(/</g,"&lt;"),e="textContent"in G?G.textContent:G.innerText),c+e+d}function h(a){return a.replace(/&/g,"&amp;").replace(u,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(v,function(a){var b=a.charCodeAt(0);return 159>=b||173==b||b>=1536&&1540>=b||1807==b||6068==b||6069==b||b>=8204&&8207>=b||b>=8232&&8239>=b||b>=8288&&8303>=b||65279==b||b>=65520&&65535>=b?"&#"+b+";":a}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function i(a){var c="",d=a.split(";");return b.forEach(d,function(a){var d=a.split(":");if(2==d.length){var e=I(b.lowercase(d[0])),a=I(b.lowercase(d[1]));("color"===e&&(a.match(/^rgb\([0-9%,\. ]*\)$/i)||a.match(/^rgba\([0-9%,\. ]*\)$/i)||a.match(/^hsl\([0-9%,\. ]*\)$/i)||a.match(/^hsla\([0-9%,\. ]*\)$/i)||a.match(/^#[0-9a-f]{3,6}$/i)||a.match(/^[a-z]*$/i))||"text-align"===e&&("left"===a||"right"===a||"center"===a||"justify"===a)||"float"===e&&("left"===a||"right"===a||"none"===a)||("width"===e||"height"===e)&&a.match(/[0-9\.]*(px|em|rem|%)/))&&(c+=e+": "+a+";")}}),c}function j(a,b,c,d){return"img"===a&&b["ta-insert-video"]&&("ta-insert-video"===c||"allowfullscreen"===c||"frameborder"===c||"contenteditble"===c&&"false"===d)?!0:!1}function k(a,c){var d=!1,e=b.bind(a,a.push);return{start:function(a,f,g){a=b.lowercase(a),!d&&C[a]&&(d=a),d||D[a]!==!0||(e("<"),e(a),b.forEach(f,function(d,g){var k=b.lowercase(g),l="img"===a&&"src"===k||"background"===k;("style"===k&&""!==(d=i(d))||j(a,f,k,d)||F[k]===!0&&(E[k]!==!0||c(d,l)))&&(e(" "),e(g),e('="'),e(h(d)),e('"'))}),e(g?"/>":">"))},end:function(a){a=b.lowercase(a),d||D[a]!==!0||(e("</"),e(a),e(">")),a==d&&(d=!1)},chars:function(a){d||e(h(a))}}}var l=b.$$minErr("$sanitize"),m=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,n=/^<\s*\/\s*([\w:-]+)[^>]*>/,o=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,q=/^<\s*\//,r=/<!--(.*?)-->/g,s=/<!DOCTYPE([^>]*?)>/i,t=/<!\[CDATA\[(.*?)]]>/g,u=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v=/([^\#-~| |!])/g,w=e("area,br,col,hr,img,wbr"),x=e("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y=e("rp,rt"),z=b.extend({},y,x),A=b.extend({},x,e("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),B=b.extend({},y,e("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),C=e("script,style"),D=b.extend({},w,A,B,z),E=e("background,cite,href,longdesc,src,usemap"),F=b.extend({},E,e("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),G=document.createElement("pre"),H=/^(\s*)([\s\S]*?)(\s*)$/,I=function(){return String.prototype.trim?function(a){return b.isString(a)?a.trim():a
}:function(a){return b.isString(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}();b.module("ngSanitize",[]).provider("$sanitize",c),b.module("ngSanitize").filter("linky",["$sanitize",function(a){var c=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,e=/^mailto:/;return function(f,g){function h(a){a&&n.push(d(a))}function i(a,c){n.push("<a "),b.isDefined(g)&&(n.push('target="'),n.push(g),n.push('" ')),n.push('href="'),n.push(a),n.push('">'),h(c),n.push("</a>")}if(!f)return f;for(var j,k,l,m=f,n=[];j=m.match(c);)k=j[0],j[2]==j[3]&&(k="mailto:"+k),l=j.index,h(m.substr(0,l)),i(k,j[0].replace(e,"")),m=m.substring(l+j[0].length);return h(m),a(n.join(""))}}])}(window,window.angular),angular.module("textAngularSetup",[]).value("taOptions",{toolbar:[["h1","h2","h3","h4","h5","h6","p","pre","quote"],["bold","italics","underline","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight","indent","outdent"],["html","insertImage","insertLink","insertVideo"]],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},setup:{textEditorSetup:function(){},htmlEditorSetup:function(){}},defaultFileDropHandler:function(a,b){var c=new FileReader;return"image"===a.type.substring(0,5)?(c.onload=function(){""!==c.result&&b("insertImage",c.result,!0)},c.readAsDataURL(a),!0):!1}}).value("taSelectableElements",["a","img"]).value("taCustomRenderers",[{selector:"img",customAttribute:"ta-insert-video",renderLogic:function(a){var b=angular.element("<iframe></iframe>"),c=a.prop("attributes");angular.forEach(c,function(a){b.attr(a.name,a.value)}),b.attr("src",b.attr("ta-insert-video")),a.replaceWith(b)}}]).constant("taTranslations",{html:{buttontext:"Toggle HTML",tooltip:"Toggle html / Rich Text"},heading:{tooltip:"Heading "},p:{tooltip:"Paragraph"},pre:{tooltip:"Preformatted text"},ul:{tooltip:"Unordered List"},ol:{tooltip:"Ordered List"},quote:{tooltip:"Quote/unqoute selection or paragraph"},undo:{tooltip:"Undo"},redo:{tooltip:"Redo"},bold:{tooltip:"Bold"},italic:{tooltip:"Italic"},underline:{tooltip:"Underline"},justifyLeft:{tooltip:"Align text left"},justifyRight:{tooltip:"Align text right"},justifyCenter:{tooltip:"Center"},indent:{tooltip:"Increase indent"},outdent:{tooltip:"Decrease indent"},clear:{tooltip:"Clear formatting"},insertImage:{dialogPrompt:"Please enter an image URL to insert",tooltip:"Insert image",hotkey:"the - possibly language dependent hotkey ... for some future implementation"},insertVideo:{tooltip:"Insert video",dialogPrompt:"Please enter a youtube URL to embed"},insertLink:{tooltip:"Insert / edit link",dialogPrompt:"Please enter a URL to insert"}}).run(["taRegisterTool","$window","taTranslations","taSelection",function(a,b,c,d){a("html",{buttontext:c.html.buttontext,tooltiptext:c.html.tooltip,action:function(){this.$editor().switchView()},activeState:function(){return this.$editor().showHtml}});var e=function(a){return function(){return this.$editor().queryFormatBlockState(a)}},f=function(){return this.$editor().wrapSelection("formatBlock","<"+this.name.toUpperCase()+">")};angular.forEach(["h1","h2","h3","h4","h5","h6"],function(b){a(b.toLowerCase(),{buttontext:b.toUpperCase(),tooltiptext:c.heading.tooltip+b.charAt(1),action:f,activeState:e(b.toLowerCase())})}),a("p",{buttontext:"P",tooltiptext:c.p.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<P>")},activeState:function(){return this.$editor().queryFormatBlockState("p")}}),a("pre",{buttontext:"pre",tooltiptext:c.pre.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<PRE>")},activeState:function(){return this.$editor().queryFormatBlockState("pre")}}),a("ul",{iconclass:"fa fa-list-ul",tooltiptext:c.ul.tooltip,action:function(){return this.$editor().wrapSelection("insertUnorderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertUnorderedList")}}),a("ol",{iconclass:"fa fa-list-ol",tooltiptext:c.ol.tooltip,action:function(){return this.$editor().wrapSelection("insertOrderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertOrderedList")}}),a("quote",{iconclass:"fa fa-quote-right",tooltiptext:c.quote.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}}),a("undo",{iconclass:"fa fa-undo",tooltiptext:c.undo.tooltip,action:function(){return this.$editor().wrapSelection("undo",null)}}),a("redo",{iconclass:"fa fa-repeat",tooltiptext:c.redo.tooltip,action:function(){return this.$editor().wrapSelection("redo",null)}}),a("bold",{iconclass:"fa fa-bold",tooltiptext:c.bold.tooltip,action:function(){return this.$editor().wrapSelection("bold",null)},activeState:function(){return this.$editor().queryCommandState("bold")},commandKeyCode:98}),a("justifyLeft",{iconclass:"fa fa-align-left",tooltiptext:c.justifyLeft.tooltip,action:function(){return this.$editor().wrapSelection("justifyLeft",null)},activeState:function(a){var b=!1;return a&&(b="left"===a.css("text-align")||"left"===a.attr("align")||"right"!==a.css("text-align")&&"center"!==a.css("text-align")&&!this.$editor().queryCommandState("justifyRight")&&!this.$editor().queryCommandState("justifyCenter")),b=b||this.$editor().queryCommandState("justifyLeft")}}),a("justifyRight",{iconclass:"fa fa-align-right",tooltiptext:c.justifyRight.tooltip,action:function(){return this.$editor().wrapSelection("justifyRight",null)},activeState:function(a){var b=!1;return a&&(b="right"===a.css("text-align")),b=b||this.$editor().queryCommandState("justifyRight")}}),a("justifyCenter",{iconclass:"fa fa-align-center",tooltiptext:c.justifyCenter.tooltip,action:function(){return this.$editor().wrapSelection("justifyCenter",null)},activeState:function(a){var b=!1;return a&&(b="center"===a.css("text-align")),b=b||this.$editor().queryCommandState("justifyCenter")}}),a("indent",{iconclass:"fa fa-indent",tooltiptext:c.indent.tooltip,action:function(){return this.$editor().wrapSelection("indent",null)},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}}),a("outdent",{iconclass:"fa fa-outdent",tooltiptext:c.outdent.tooltip,action:function(){return this.$editor().wrapSelection("outdent",null)},activeState:function(){return!1}}),a("italics",{iconclass:"fa fa-italic",tooltiptext:c.italic.tooltip,action:function(){return this.$editor().wrapSelection("italic",null)},activeState:function(){return this.$editor().queryCommandState("italic")},commandKeyCode:105}),a("underline",{iconclass:"fa fa-underline",tooltiptext:c.underline.tooltip,action:function(){return this.$editor().wrapSelection("underline",null)},activeState:function(){return this.$editor().queryCommandState("underline")},commandKeyCode:117}),a("clear",{iconclass:"fa fa-ban",tooltiptext:c.clear.tooltip,action:function(a,b){this.$editor().wrapSelection("removeFormat",null);var c=angular.element(d.getSelectionElement()),e=function(a){a=angular.element(a);var b=a;angular.forEach(a.children(),function(a){var c=angular.element("<p></p>");c.html(angular.element(a).html()),b.after(c),b=c}),a.remove()};angular.forEach(c.find("ul"),e),angular.forEach(c.find("ol"),e);var f=this.$editor(),g=function(a){a=angular.element(a),a[0]!==f.displayElements.text[0]&&a.removeAttr("class"),angular.forEach(a.children(),g)};angular.forEach(c,g),"li"!==c[0].tagName.toLowerCase()&&"ol"!==c[0].tagName.toLowerCase()&&"ul"!==c[0].tagName.toLowerCase()&&this.$editor().wrapSelection("formatBlock","<p>"),b()}});var g=function(a,b,c){var d=function(){c.updateTaBindtaTextElement(),c.hidePopover()};a.preventDefault(),c.displayElements.popover.css("width","375px");var e=c.displayElements.popoverContainer;e.empty();var f=angular.element('<div class="btn-group" style="padding-right: 6px;">'),g=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% </button>');g.on("click",function(a){a.preventDefault(),b.css({width:"100%",height:""}),d()});var h=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% </button>');h.on("click",function(a){a.preventDefault(),b.css({width:"50%",height:""}),d()});var i=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% </button>');i.on("click",function(a){a.preventDefault(),b.css({width:"25%",height:""}),d()});var j=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset</button>');j.on("click",function(a){a.preventDefault(),b.css({width:"",height:""}),d()}),f.append(g),f.append(h),f.append(i),f.append(j),e.append(f),f=angular.element('<div class="btn-group" style="padding-right: 6px;">');var k=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"></i></button>');k.on("click",function(a){a.preventDefault(),b.css("float","left"),d()});var l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"></i></button>');l.on("click",function(a){a.preventDefault(),b.css("float","right"),d()});var m=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"></i></button>');m.on("click",function(a){a.preventDefault(),b.css("float",""),d()}),f.append(k),f.append(m),f.append(l),e.append(f),f=angular.element('<div class="btn-group">');var n=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"></i></button>');n.on("click",function(a){a.preventDefault(),b.remove(),d()}),f.append(n),e.append(f),c.showPopover(b),c.showResizeOverlay(b)};a("insertImage",{iconclass:"fa fa-picture-o",tooltiptext:c.insertImage.tooltip,action:function(){var a;return a=b.prompt(c.insertImage.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a?this.$editor().wrapSelection("insertImage",a,!0):void 0},onElementSelect:{element:"img",action:g}}),a("insertVideo",{iconclass:"fa fa-youtube-play",tooltiptext:c.insertVideo.tooltip,action:function(){var a;if(a=b.prompt(c.insertVideo.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a){var d=a.match(/(\?|&)v=[^&]*/);if(d.length>0){var e="http://www.youtube.com/embed/"+d[0].substring(3),f='<img class="ta-insert-video" ta-insert-video="'+e+'" contenteditable="false" src="" allowfullscreen="true" width="300" frameborder="0" height="250"/>';return this.$editor().wrapSelection("insertHTML",f,!0)}}},onElementSelect:{element:"img",onlyWithAttrs:["ta-insert-video"],action:g}}),a("insertLink",{tooltiptext:c.insertLink.tooltip,iconclass:"fa fa-link",action:function(){var a;return a=b.prompt(c.insertLink.dialogPrompt,"http://"),a&&""!==a&&"http://"!==a?this.$editor().wrapSelection("createLink",a,!0):void 0},activeState:function(a){return a?"A"===a[0].tagName:!1},onElementSelect:{element:"a",action:function(a,d,e){a.preventDefault(),e.displayElements.popover.css("width","435px");var f=e.displayElements.popoverContainer;f.empty(),f.css("line-height","28px");var g=angular.element('<a href="'+d.attr("href")+'" target="_blank">'+d.attr("href")+"</a>");g.css({display:"inline-block","max-width":"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","vertical-align":"middle"}),f.append(g);var h=angular.element('<div class="btn-group pull-right">'),i=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on"><i class="fa fa-edit icon-edit"></i></button>');i.on("click",function(a){a.preventDefault();var f=b.prompt(c.insertLink.dialogPrompt,d.attr("href"));f&&""!==f&&"http://"!==f&&(d.attr("href",f),e.updateTaBindtaTextElement()),e.hidePopover()}),h.append(i);var j=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on"><i class="fa fa-unlink icon-unlink"></i></button>');j.on("click",function(a){a.preventDefault(),d.replaceWith(d.contents()),e.updateTaBindtaTextElement(),e.hidePopover()}),h.append(j);var k=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">Open in New Window</button>');"_blank"===d.attr("target")&&k.addClass("active"),k.on("click",function(a){a.preventDefault(),d.attr("target","_blank"===d.attr("target")?"":"_blank"),k.toggleClass("active"),e.updateTaBindtaTextElement()}),h.append(k),f.append(h),e.showPopover(d)}}})}]),angular.module("pascalprecht.translate",["ng"]).run(["$translate",function(a){var b=a.storageKey(),c=a.storage(),d=function(){var d=a.preferredLanguage();angular.isString(d)?a.use(d):c.put(b,a.use())};c?c.get(b)?a.use(c.get(b))["catch"](d):d():angular.isString(a.preferredLanguage())&&a.use(a.preferredLanguage())}]),angular.module("pascalprecht.translate").provider("$translate",["$STORAGE_KEY",function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={},r=[],s=a,t=[],u=!1,v="translate-cloak",w=!1,x=".",y="2.5.2",z=function(){var a,b,c=window.navigator,d=["language","browserLanguage","systemLanguage","userLanguage"];if(angular.isArray(c.languages))for(a=0;a<c.languages.length;a++)if(b=c.languages[a],b&&b.length)return b;for(a=0;a<d.length;a++)if(b=c[d[a]],b&&b.length)return b;return null};z.displayName="angular-translate/service: getFirstBrowserLanguage";var A=function(){return(z()||"").split("-").join("_")};A.displayName="angular-translate/service: getLocale";var B=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},C=function(){return this.replace(/^\s+|\s+$/g,"")},D=function(a){for(var b=[],d=angular.lowercase(a),e=0,f=r.length;f>e;e++)b.push(angular.lowercase(r[e]));if(B(b,d)>-1)return a;if(c){var g;for(var h in c){var i=!1,j=Object.prototype.hasOwnProperty.call(c,h)&&angular.lowercase(h)===angular.lowercase(a);if("*"===h.slice(-1)&&(i=h.slice(0,-1)===a.slice(0,h.length-1)),(j||i)&&(g=c[h],B(b,angular.lowercase(g))>-1))return g}}var k=a.split("_");return k.length>1&&B(b,angular.lowercase(k[0]))>-1?k[0]:a},E=function(a,b){if(!a&&!b)return q;if(a&&!b){if(angular.isString(a))return q[a]}else angular.isObject(q[a])||(q[a]={}),angular.extend(q[a],F(b));return this};this.translations=E,this.cloakClassName=function(a){return a?(v=a,this):v};var F=function(a,b,c,d){var e,f,g,h;b||(b=[]),c||(c={});for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(h=a[e],angular.isObject(h)?F(h,b.concat(e),c,e):(f=b.length?""+b.join(x)+x+e:e,b.length&&e===d&&(g=""+b.join(x),c[g]="@:"+f),c[f]=h));return c};this.addInterpolation=function(a){return t.push(a),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(a){return k=a,this},this.useSanitizeValueStrategy=function(a){return u=a,this},this.preferredLanguage=function(a){return G(a),this};var G=function(a){return a&&(b=a),b};this.translationNotFoundIndicator=function(a){return this.translationNotFoundIndicatorLeft(a),this.translationNotFoundIndicatorRight(a),this},this.translationNotFoundIndicatorLeft=function(a){return a?(n=a,this):n},this.translationNotFoundIndicatorRight=function(a){return a?(o=a,this):o},this.fallbackLanguage=function(a){return H(a),this};var H=function(a){return a?(angular.isString(a)?(e=!0,d=[a]):angular.isArray(a)&&(e=!1,d=a),angular.isString(b)&&B(d,b)<0&&d.push(b),this):e?d[0]:d};this.use=function(a){if(a){if(!q[a]&&!l)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+a+"'");return f=a,this}return f};var I=function(a){return a?void(s=a):i?i+s:s};this.storageKey=I,this.useUrlLoader=function(a,b){return this.useLoader("$translateUrlLoader",angular.extend({url:a},b))},this.useStaticFilesLoader=function(a){return this.useLoader("$translateStaticFilesLoader",a)},this.useLoader=function(a,b){return l=a,m=b||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(a){return h=a,this},this.storagePrefix=function(a){return a?(i=a,this):a},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(a){return j=a,this},this.usePostCompiling=function(a){return w=!!a,this},this.determinePreferredLanguage=function(a){var c=a&&angular.isFunction(a)?a():A();return b=r.length?D(c):c,this},this.registerAvailableLanguageKeys=function(a,b){return a?(r=a,b&&(c=b),this):r},this.useLoaderCache=function(a){return a===!1?p=void 0:a===!0?p=!0:"undefined"==typeof a?p="$translationCache":a&&(p=a),this},this.$get=["$log","$injector","$rootScope","$q",function(a,c,i,r){var x,z,A,J=c.get(k||"$translateDefaultInterpolation"),K=!1,L={},M={},N=function(a,c,e){if(angular.isArray(a)){var g=function(a){for(var b={},d=[],f=function(a){var d=r.defer(),f=function(c){b[a]=c,d.resolve([a,c])};return N(a,c,e).then(f,f),d.promise},g=0,h=a.length;h>g;g++)d.push(f(a[g]));return r.all(d).then(function(){return b})};return g(a)}var i=r.defer();a&&(a=C.apply(a));var j=function(){var a=b?M[b]:M[f];if(z=0,h&&!a){var c=x.get(s);if(a=M[c],d&&d.length){var e=B(d,c);z=0===e?1:0,B(d,b)<0&&d.push(b)}}return a}();return j?j.then(function(){Z(a,c,e).then(i.resolve,i.reject)},i.reject):Z(a,c,e).then(i.resolve,i.reject),i.promise},O=function(a){return n&&(a=[n,a].join(" ")),o&&(a=[a,o].join(" ")),a},P=function(a){f=a,i.$emit("$translateChangeSuccess",{language:a}),h&&x.put(N.storageKey(),f),J.setLocale(f),angular.forEach(L,function(a,b){L[b].setLocale(f)}),i.$emit("$translateChangeEnd",{language:a})},Q=function(a){if(!a)throw"No language key specified for loading.";var b=r.defer();i.$emit("$translateLoadingStart",{language:a}),K=!0;var d=p;"string"==typeof d&&(d=c.get(d));var e=angular.extend({},m,{key:a,$http:angular.extend({},{cache:d},m.$http)});return c.get(l)(e).then(function(c){var d={};i.$emit("$translateLoadingSuccess",{language:a}),angular.isArray(c)?angular.forEach(c,function(a){angular.extend(d,F(a))}):angular.extend(d,F(c)),K=!1,b.resolve({key:a,table:d}),i.$emit("$translateLoadingEnd",{language:a})},function(a){i.$emit("$translateLoadingError",{language:a}),b.reject(a),i.$emit("$translateLoadingEnd",{language:a})}),b.promise};if(h&&(x=c.get(h),!x.get||!x.put))throw new Error("Couldn't use storage '"+h+"', missing get() or put() method!");angular.isFunction(J.useSanitizeValueStrategy)&&J.useSanitizeValueStrategy(u),t.length&&angular.forEach(t,function(a){var d=c.get(a);d.setLocale(b||f),angular.isFunction(d.useSanitizeValueStrategy)&&d.useSanitizeValueStrategy(u),L[d.getInterpolationIdentifier()]=d});var R=function(a){var b=r.defer();return Object.prototype.hasOwnProperty.call(q,a)?b.resolve(q[a]):M[a]?M[a].then(function(a){E(a.key,a.table),b.resolve(a.table)},b.reject):b.reject(),b.promise},S=function(a,b,c,d){var e=r.defer();return R(a).then(function(g){Object.prototype.hasOwnProperty.call(g,b)?(d.setLocale(a),e.resolve(d.interpolate(g[b],c)),d.setLocale(f)):e.reject()},e.reject),e.promise},T=function(a,b,c,d){var e,g=q[a];return g&&Object.prototype.hasOwnProperty.call(g,b)&&(d.setLocale(a),e=d.interpolate(g[b],c),d.setLocale(f)),e},U=function(a){if(j){var b=c.get(j)(a,f);return void 0!==b?b:a}return a},V=function(a,b,c,e){var f=r.defer();if(a<d.length){var g=d[a];S(g,b,c,e).then(f.resolve,function(){V(a+1,b,c,e).then(f.resolve)})}else f.resolve(U(b));return f.promise},W=function(a,b,c,e){var f;if(a<d.length){var g=d[a];f=T(g,b,c,e),f||(f=W(a+1,b,c,e))}return f},X=function(a,b,c){return V(A>0?A:z,a,b,c)},Y=function(a,b,c){return W(A>0?A:z,a,b,c)},Z=function(a,b,c){var e=r.defer(),g=f?q[f]:q,h=c?L[c]:J;if(g&&Object.prototype.hasOwnProperty.call(g,a)){var i=g[a];"@:"===i.substr(0,2)?N(i.substr(2),b,c).then(e.resolve,e.reject):e.resolve(h.interpolate(i,b))}else{var k;j&&!K&&(k=U(a)),f&&d&&d.length?X(a,b,h).then(function(a){e.resolve(a)},function(a){e.reject(O(a))}):j&&!K&&k?e.resolve(k):e.reject(O(a))}return e.promise},$=function(a,b,c){var e,g=f?q[f]:q,h=c?L[c]:J;if(g&&Object.prototype.hasOwnProperty.call(g,a)){var i=g[a];e="@:"===i.substr(0,2)?$(i.substr(2),b,c):h.interpolate(i,b)}else{var k;j&&!K&&(k=U(a)),f&&d&&d.length?(z=0,e=Y(a,b,h)):e=j&&!K&&k?k:O(a)}return e};if(N.preferredLanguage=function(a){return a&&G(a),b},N.cloakClassName=function(){return v},N.fallbackLanguage=function(a){if(void 0!==a&&null!==a){if(H(a),l&&d&&d.length)for(var b=0,c=d.length;c>b;b++)M[d[b]]||(M[d[b]]=Q(d[b]));N.use(N.use())}return e?d[0]:d},N.useFallbackLanguage=function(a){if(void 0!==a&&null!==a)if(a){var b=B(d,a);b>-1&&(A=b)}else A=0},N.proposedLanguage=function(){return g},N.storage=function(){return x},N.use=function(a){if(!a)return f;var b=r.defer();i.$emit("$translateChangeStart",{language:a});var c=D(a);return c&&(a=c),q[a]||!l||M[a]?(b.resolve(a),P(a)):(g=a,M[a]=Q(a).then(function(c){return E(c.key,c.table),b.resolve(c.key),P(c.key),g===a&&(g=void 0),c},function(a){g===a&&(g=void 0),i.$emit("$translateChangeError",{language:a}),b.reject(a),i.$emit("$translateChangeEnd",{language:a})})),b.promise},N.storageKey=function(){return I()},N.isPostCompilingEnabled=function(){return w},N.refresh=function(a){function b(){e.resolve(),i.$emit("$translateRefreshEnd",{language:a})}function c(){e.reject(),i.$emit("$translateRefreshEnd",{language:a})}if(!l)throw new Error("Couldn't refresh translation table, no loader registered!");var e=r.defer();if(i.$emit("$translateRefreshStart",{language:a}),a)q[a]?Q(a).then(function(c){E(c.key,c.table),a===f&&P(f),b()},c):c();else{var g=[],h={};if(d&&d.length)for(var j=0,k=d.length;k>j;j++)g.push(Q(d[j])),h[d[j]]=!0;f&&!h[f]&&g.push(Q(f)),r.all(g).then(function(a){angular.forEach(a,function(a){q[a.key]&&delete q[a.key],E(a.key,a.table)}),f&&P(f),b()})}return e.promise},N.instant=function(a,c,e){if(null===a||angular.isUndefined(a))return a;if(angular.isArray(a)){for(var g={},h=0,i=a.length;i>h;h++)g[a[h]]=N.instant(a[h],c,e);return g}if(angular.isString(a)&&a.length<1)return a;a&&(a=C.apply(a));var k,l=[];b&&l.push(b),f&&l.push(f),d&&d.length&&(l=l.concat(d));for(var m=0,n=l.length;n>m;m++){var o=l[m];if(q[o]&&"undefined"!=typeof q[o][a]&&(k=$(a,c,e)),"undefined"!=typeof k)break}return k||""===k||(k=J.interpolate(a,c),j&&!K&&(k=U(a))),k},N.versionInfo=function(){return y},N.loaderCache=function(){return p},l&&(angular.equals(q,{})&&N.use(N.use()),d&&d.length))for(var _=function(a){return E(a.key,a.table),i.$emit("$translateChangeEnd",{language:a.key}),a},ab=0,bb=d.length;bb>ab;ab++)M[d[ab]]=Q(d[ab]).then(_);return N}]}]),angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",["$interpolate",function(a){var b,c={},d="default",e=null,f={escaped:function(a){var b={};for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=angular.element("<div></div>").text(a[c]).html());return b}},g=function(a){var b;return b=angular.isFunction(f[e])?f[e](a):a};return c.setLocale=function(a){b=a},c.getInterpolationIdentifier=function(){return d},c.useSanitizeValueStrategy=function(a){return e=a,this},c.interpolate=function(b,c){return e&&(c=g(c)),a(b)(c||{})},c}]),angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",["$translate","$q","$interpolate","$compile","$parse","$rootScope",function(a,b,c,d,e,f){return{restrict:"AE",scope:!0,compile:function(b,g){var h=g.translateValues?g.translateValues:void 0,i=g.translateInterpolation?g.translateInterpolation:void 0,j=b[0].outerHTML.match(/translate-value-+/i),k="^(.*)("+c.startSymbol()+".*"+c.endSymbol()+")(.*)",l="^(.*)"+c.startSymbol()+"(.*)"+c.endSymbol()+"(.*)";return function(b,m,n){b.interpolateParams={},b.preText="",b.postText="";var o={},p=function(a){if(angular.equals(a,"")||!angular.isDefined(a)){var d=m.text().match(k);angular.isArray(d)?(b.preText=d[1],b.postText=d[3],o.translate=c(d[2])(b.$parent),watcherMatches=m.text().match(l),angular.isArray(watcherMatches)&&watcherMatches[2]&&watcherMatches[2].length&&b.$watch(watcherMatches[2],function(a){o.translate=a,u()})):o.translate=m.text().replace(/^\s+|\s+$/g,"")}else o.translate=a;u()},q=function(a){n.$observe(a,function(b){o[a]=b,u()})};n.$observe("translate",function(a){p(a)});for(var r in n)n.hasOwnProperty(r)&&"translateAttr"===r.substr(0,13)&&q(r);if(n.$observe("translateDefault",function(a){b.defaultText=a}),h&&n.$observe("translateValues",function(a){a&&b.$parent.$watch(function(){angular.extend(b.interpolateParams,e(a)(b.$parent))})}),j){var s=function(a){n.$observe(a,function(c){var d=angular.lowercase(a.substr(14,1))+a.substr(15);b.interpolateParams[d]=c})};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&"translateValue"===t.substr(0,14)&&"translateValues"!==t&&s(t)}var u=function(){for(var a in o)o.hasOwnProperty(a)&&o[a]&&v(a,o[a],b,b.interpolateParams)},v=function(b,c,d,e){a(c,e,i).then(function(a){w(a,d,!0,b)},function(a){w(a,d,!1,b)})},w=function(b,c,e,f){if("translate"===f){e||"undefined"==typeof c.defaultText||(b=c.defaultText),m.html(c.preText+b+c.postText);var h=a.isPostCompilingEnabled(),i="undefined"!=typeof g.translateCompile,j=i&&"false"!==g.translateCompile;(h&&!i||j)&&d(m.contents())(c)}else{e||"undefined"==typeof c.defaultText||(b=c.defaultText);var k=n.$attr[f].substr(15);m.attr(k,b)}};b.$watch("interpolateParams",u,!0);var x=f.$on("$translateChangeSuccess",u);m.text().length&&p(""),u(),b.$on("$destroy",x)}}}}]),angular.module("pascalprecht.translate").directive("translateCloak",["$rootScope","$translate",function(a,b){return{compile:function(c){var d=function(){c.addClass(b.cloakClassName())},e=function(){c.removeClass(b.cloakClassName())},f=a.$on("$translateChangeEnd",function(){e(),f(),f=null});return d(),function(a,c,f){f.translateCloak&&f.translateCloak.length&&f.$observe("translateCloak",function(a){b(a).then(e,d)})}}}}]),angular.module("pascalprecht.translate").filter("translate",["$parse","$translate",function(a,b){var c=function(c,d,e){return angular.isObject(d)||(d=a(d)(this)),b.instant(c,d,e)};return c.$stateful=!0,c}]),function(a){function b(a,b){a=new Date(a||new Date),a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours());for(var c=[],d=a.getTime()+36e5;a.getTime()<d;)c.push(a),a=new Date(a.getTime()+60*b*1e3);return c}function c(a){a=new Date(a||new Date),a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setDate(0===a.getDay()?-5:a.getDate()-(a.getDay()-1)),1===a.getDate()&&a.setDate(-6);for(var b=[];b.length<6;){for(var c=[],d=0;7>d;d++)c.push(new Date(a)),a.setDate(a.getDate()+1);b.push(c)}return b}function d(a){var b=[];a=new Date(a||new Date),a.setFullYear(a.getFullYear()-a.getFullYear()%10);for(var c=0;12>c;c++)b.push(new Date(a.getFullYear()+(c-1),0,1));return b}function e(a){a=new Date(a||new Date),a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),a.setDate(a.getDate()-(a.getDay()-1));for(var b=[],c=0;7>c;c++)b.push(new Date(a)),a.setDate(a.getDate()+1);return b}function f(a){a=new Date(a||new Date);for(var b=a.getFullYear(),c=[],d=0;12>d;d++)c.push(new Date(b,d,1));return c}function g(a){a=new Date(a||new Date),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);for(var b=[],c=0;24>c;c++)b.push(a),a=new Date(a.getTime()+36e5);return b}var h=a.module("datePicker",[]);h.constant("datePickerConfig",{template:"templates/datepicker.html",view:"month",views:["year","month","date","hours","minutes"],step:5}),h.directive("datePicker",["datePickerConfig",function(a){return{template:'<div ng-include="template"></div>',scope:{model:"=datePicker",after:"=?",before:"=?"},link:function(h,i,j){function k(){var a=h.view,i=h.date;switch(a){case"year":h.years=d(i);break;case"month":h.months=f(i);break;case"date":h.weekdays=h.weekdays||e(),h.weeks=c(i);break;case"hours":h.hours=g(i);break;case"minutes":h.minutes=b(i,m)}}function l(){return"date"!==h.view?h.view:h.model?h.model.getMonth():null}h.date=new Date(h.model||new Date),h.views=a.views.concat(),h.view=j.view||a.view,h.now=new Date,h.template=j.template||a.template;var m=parseInt(j.step||a.step,10);h.views=h.views.slice(h.views.indexOf(j.maxView||"year"),h.views.indexOf(j.minView||"minutes")+1),(1===h.views.length||-1===h.views.indexOf(h.view))&&(h.view=h.views[0]),h.setView=function(a){-1!==h.views.indexOf(a)&&(h.view=a)},h.setDate=function(a){h.date=a;var b=h.views[h.views.indexOf(h.view)+1];if(!b||h.model){switch(h.model=new Date(h.model||a),h.view){case"minutes":h.model.setMinutes(a.getMinutes());case"hours":h.model.setHours(a.getHours());case"date":h.model.setDate(a.getDate());case"month":h.model.setMonth(a.getMonth());case"year":h.model.setFullYear(a.getFullYear())}h.$emit("setDate",h.model,h.view)}b&&h.setView(b)},h.$watch(l,k),h.next=function(a){var b=h.date;switch(a=a||1,h.view){case"year":case"month":b.setFullYear(b.getFullYear()+a);break;case"date":b.setMonth(b.getMonth()+a);break;case"hours":case"minutes":b.setHours(b.getHours()+a)}k()},h.prev=function(a){return h.next(-a||-1)},h.isAfter=function(a){return h.after?h.after.getTime()<=a.getTime():!1},h.isBefore=function(a){return h.before?h.before.getTime()>=a.getTime():!1},h.isSameMonth=function(a){return h.isSameYear(a)&&h.model.getMonth()===a.getMonth()},h.isSameYear=function(a){return h.model?h.model.getFullYear()===a.getFullYear():!1},h.isSameDay=function(a){return h.isSameMonth(a)&&h.model.getDate()===a.getDate()},h.isSameHour=function(a){return h.isSameDay(a)&&h.model.getHours()===a.getHours()},h.isSameMinutes=function(a){return h.isSameHour(a)&&h.model.getMinutes()===a.getMinutes()},h.isNow=function(a){var b=!0,c=h.now;switch(h.view){case"minutes":b&=~~(a.getMinutes()/m)===~~(c.getMinutes()/m);case"hours":b&=a.getHours()===c.getHours();case"date":b&=a.getDate()===c.getDate();case"month":b&=a.getMonth()===c.getMonth();case"year":b&=a.getFullYear()===c.getFullYear()}return b}}}}]);var h=a.module("datePicker");h.directive("dateRange",function(){return{templateUrl:"templates/daterange.html",scope:{start:"=",end:"="},link:function(a){a.$watch("start.getTime()",function(b){b&&a.end&&b>a.end.getTime()&&(a.end=new Date(b))}),a.$watch("end.getTime()",function(b){b&&a.start&&b<a.start.getTime()&&(a.start=new Date(b))})}}});var i="ng-pristine",j="ng-dirty",h=a.module("datePicker");h.constant("dateTimeConfig",{template:function(a){return'<div date-picker="'+a.ngModel+'" '+(a.view?'view="'+a.view+'" ':"")+(a.maxView?'max-view="'+a.maxView+'" ':"")+(a.template?'template="'+a.template+'" ':"")+(a.minView?'min-view="'+a.minView+'" ':"")+'class="dropdown-menu"></div>'},format:"yyyy-MM-dd HH:mm",views:["date","year","month","hours","minutes"],dismiss:!1,position:"relative"}),h.directive("dateTimeAppend",function(){return{link:function(a,b){b.bind("click",function(){b.find("input")[0].focus()})}}}),h.directive("dateTime",["$compile","$document","$filter","dateTimeConfig","$parse",function(b,c,d,e,f){var g=c.find("body"),h=d("date");return{require:"ngModel",scope:!0,link:function(c,d,k,l){function m(a){return h(a,r)}function n(){return l.$modelValue}function o(a){a.stopPropagation(),l.$pristine&&(l.$dirty=!0,l.$pristine=!1,d.removeClass(i).addClass(j),s&&s.$setDirty(),l.$render())}function p(){x&&(x.remove(),x=null),z&&(z.remove(),z=null)}function q(){if(!x){if(x=b(A)(c),c.$digest(),c.$on("setDate",function(a,b,c){o(a),w&&t[t.length-1]===c&&p()}),c.$on("$destroy",p),"absolute"===y){var e=a.extend(d.offset(),{height:d[0].offsetHeight});x.css({top:e.top+e.height,left:e.left,display:"block",position:y}),g.append(x)}else z=a.element("<div date-picker-wrapper></div>"),d[0].parentElement.insertBefore(z[0],d[0]),z.append(x),x.css({top:d[0].offsetHeight+"px",display:"block"});
x.bind("mousedown",function(a){a.preventDefault()})}}var r=k.format||e.format,s=d.inheritedData("$formController"),t=f(k.views)(c)||e.views.concat(),u=k.view||t[0],v=t.indexOf(u),w=k.dismiss?f(k.dismiss)(c):e.dismiss,x=null,y=k.position||e.position,z=null;-1===v&&t.splice(v,1),t.unshift(u),l.$formatters.push(m),l.$parsers.unshift(n);var A=e.template(k);d.bind("focus",q),d.bind("blur",p)}}}]),a.module("datePicker").run(["$templateCache",function(a){a.put("templates/datepicker.html",'<div ng-switch="view">\n  <div ng-switch-when="date">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹</th>\n        <th colspan="5" class="switch" ng-click="setView(\'month\')">{{date|date:"yyyy MMMM"}}</th>\n        <th ng-click="next()">›</i></th>\n      </tr>\n      <tr>\n        <th ng-repeat="day in weekdays" style="overflow: hidden">{{ day|date:"EEE" }}</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="week in weeks">\n        <td ng-repeat="day in week">\n          <span\n            ng-class="{\'now\':isNow(day),\'active\':isSameDay(day),\'disabled\':(day.getMonth()!=date.getMonth()),\'after\':isAfter(day),\'before\':isBefore(day)}"\n            ng-click="setDate(day)" ng-bind="day.getDate()"></span>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n  <div ng-switch-when="year">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev(10)">‹</th>\n        <th colspan="5" class="switch">{{years[0].getFullYear()}}-{{years[years.length-1].getFullYear()}}</th>\n        <th ng-click="next(10)">›</i></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                    <span ng-class="{\'active\':isSameYear(year),\'now\':isNow(year)}"\n                          ng-repeat="year in years"\n                          ng-click="setDate(year)" ng-bind="year.getFullYear()"></span>\n\n\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n  <div ng-switch-when="month">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹</th>\n        <th colspan="5" class="switch" ng-click="setView(\'year\')">{{ date|date:"yyyy" }}</th>\n        <th ng-click="next()">›</i></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                <span ng-repeat="month in months"\n                      ng-class="{\'active\':isSameMonth(month),\'after\':isAfter(month),\'before\':isBefore(month),\'now\':isNow(month)}"\n                      ng-click="setDate(month)">{{month|date:\'MMM\'}}</span>\n\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n  <div ng-switch-when="hours">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev(24)">‹</th>\n        <th colspan="5" class="switch" ng-click="setView(\'date\')">{{ date|date:"dd MMMM yyyy" }}</th>\n        <th ng-click="next(24)">›</i></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                <span ng-repeat="hour in hours"\n                      ng-class="{\'now\':isNow(hour),\'active\':isSameHour(hour)}"\n                      ng-click="setDate(hour)" ng-bind="hour.getHours()+\':00\'"></span>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n  <div ng-switch-when="minutes">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹</th>\n        <th colspan="5" class="switch" ng-click="setView(\'hours\')">{{ date|date:"dd MMMM yyyy" }}\n        </th>\n        <th ng-click="next()">›</i></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                    <span ng-repeat="minute in minutes"\n                          ng-class="{active:isSameMinutes(minute),\'now\':isNow(minute)}"\n                          ng-click="setDate(minute)">{{minute|date:"HH:mm"}}</span>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n'),a.put("templates/daterange.html",'<div>\n    <table>\n        <tr>\n            <td valign="top">\n                <div date-picker="start" class="date-picker" date after="start" before="end" min-view="date" max-view="date"></div>\n            </td>\n            <td valign="top">\n                <div date-picker="end" class="date-picker" date after="start" before="end"  min-view="date" max-view="date"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n')}])}(angular);var a=function(){var a={0:{pattern:/\d/,_default:"0"},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,optional:!0,recursive:!0},S:{pattern:/[a-zA-Z]/},U:{pattern:/[a-zA-Z]/,transform:function(a){return a.toLocaleUpperCase()}},L:{pattern:/[a-zA-Z]/,transform:function(a){return a.toLocaleLowerCase()}},$:{escape:!0}},b=function(b,c){for(var d=0,e=c-1,f={escape:!0};e>=0&&f&&f.escape;)f=a[b.charAt(e)],d+=f&&f.escape?1:0,e--;return d>0&&d%2===1},c=function(a,b){var c=a.replace(/[^0]/g,"").length,d=b.replace(/[^\d]/g,"").length;return d-c},d=function(a,b,c,d){return d&&"function"==typeof d.transform&&(b=d.transform(b)),c.reverse?b+a:a+b},e=function(b,c,d){var f=b.charAt(c),g=a[f];return""===f?!1:g&&!g.escape?!0:e(b,c+d,d)},f=function(a,b,c){var d=a.split("");return d.splice(c>=0?c:0,0,b),d.join("")},g=function(h,i){this.options=i||{},this.options={reverse:this.options.reverse||!1,usedefaults:this.options.usedefaults||this.options.reverse},this.pattern=h,g.prototype.process=function(g){if(!g)return"";g+="";for(var h=this.pattern,i=!0,j="",k=this.options.reverse?g.length-1:0,l=c(h,g),m=!1,n=[],o=!1,p={start:this.options.reverse?h.length-1:0,end:this.options.reverse?-1:h.length,inc:this.options.reverse?-1:1},q=function(a){if(!o&&e(h,r,p.inc))return!0;if(o||(o=n.length>0),o){var b=n.shift();if(n.push(b),a.reverse&&k>=0)return r++,h=f(h,b,r),!0;if(!a.reverse&&k<g.length)return h=f(h,b,r),!0}return r<h.length&&r>=0},r=p.start;q(this.options);r+=p.inc){var s=h.charAt(r),t=g.charAt(k),u=a[s];if(!o||t){if(this.options.reverse&&b(h,r)){j=d(j,s,this.options,u),r+=p.inc;continue}if(!this.options.reverse&&m){j=d(j,s,this.options,u),m=!1;continue}if(!this.options.reverse&&u&&u.escape){m=!0;continue}}if(!o&&u&&u.recursive)n.push(s);else{if(o&&!t){u&&u.recursive||(j=d(j,s,this.options,u));continue}if(n.length>0&&u&&!u.recursive){i=!1;continue}if(!o&&n.length>0&&!t)continue}if(u)if(u.optional){if(u.pattern.test(t)&&l)j=d(j,t,this.options,u),k+=p.inc,l--;else if(n.length>0&&t){i=!1;break}}else if(u.pattern.test(t))j=d(j,t,this.options,u),k+=p.inc;else{if(t||!u._default||!this.options.usedefaults){i=!1;break}j=d(j,u._default,this.options,u)}else j=d(j,s,this.options,u),!o&&n.length&&n.push(s)}return{result:j,valid:i}},g.prototype.apply=function(a){return this.process(a).result},g.prototype.validate=function(a){return this.process(a).valid}};return g.process=function(a,b,c){return new g(b,c).process(a)},g.apply=function(a,b,c){return new g(b,c).apply(a)},g.validate=function(a,b,c){return new g(b,c).validate(a)},g}(),b={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};b[typeof module]&&(module.exports=a)}();